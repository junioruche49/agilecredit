{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/react app/agilecreditportal/src/pages/Bvn.tsx\";\nimport React, { useState } from \"react\";\nimport { useQuery } from \"react-query\";\nimport { withRouter } from \"react-router\";\nimport OnboardingSideBar from \"../components/OnboardingSideBar\";\nimport { useForm } from \"react-hook-form\";\nimport useProfileStore from \"../stores/profileStore\";\nimport { resolveBvn, getBvnDetailsFields, completeResolveBVN } from \"../clients/onboarding\";\nimport useAuthStore from \"../stores/authStore\";\n\nconst Bvn = props => {\n  let pageType = \"profile\";\n\n  if (props.location.pathname.includes(\"/onboarding\")) {\n    pageType = \"onboarding\";\n  }\n\n  const [loading, setLoading] = useState(false);\n  const profile = useProfileStore(state => state.data);\n  const [displayMsg, setDisplayMsg] = useState(\"\");\n  const [errorMsg, setErrorMsg] = useState([]);\n  const [otpMsg, setOtpMsg] = useState(null);\n  const [userInput, setUserInput] = useState(null);\n  const [otpRequestId, setOtpRequestId] = useState(null);\n  const [bvnDisabled, setBvnDisabled] = useState(false);\n  const [bvnVerification, setBvnVerification] = useState(false);\n  const token = useAuthStore(state => state.accessToken);\n  const {\n    isLoading,\n    error,\n    data,\n    refetch\n  } = useQuery(\"data\", () => getBvnDetailsFields(token));\n\n  if (data && data[0].completed) {\n    pageType === \"onboarding\" ? props.history.replace(\"/onboarding/personal\") : props.history.replace(\"/profile/personal\");\n  }\n\n  const {\n    register,\n    setValue,\n    handleSubmit,\n    errors\n  } = useForm();\n\n  if (isLoading) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"w-full m-auto px-8 relative\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"/img/loading-gif.gif\",\n      alt: \"\",\n      className: \"w-1/8 m-auto py-20\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 11\n      }\n    })));\n  }\n\n  const updateErrors = errors => {\n    setErrorMsg(Object.values(errors).flat());\n  };\n\n  const onOtpSubmit = async () => {\n    setErrorMsg([]);\n    setLoading(true);\n\n    try {\n      let otp = {};\n      otp[\"otp\"] = userInput;\n      otp[\"requestid\"] = otpRequestId;\n      otp[\"user_id\"] = profile[\"user_id\"];\n      const {\n        message,\n        data,\n        success\n      } = await completeResolveBVN(token, otp);\n\n      if (success === false) {\n        let msg = [];\n        msg.push(message);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      }\n\n      setErrorMsg([]);\n      setOtpMsg(message);\n      setTimeout(function () {\n        setLoading(false);\n        refetch();\n        pageType === \"onboarding\" ? props.history.push(\"/onboarding/personal\") : props.history.push(\"/profile/personal\");\n      }, 2000);\n      setLoading(false);\n      setBvnVerification(true);\n    } catch (error) {\n      setLoading(false);\n\n      if (error && error.response.status == 500) {\n        let msg = [];\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n\n      if (!error.response) {\n        let msg = [];\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n\n      const {\n        response: {\n          data\n        }\n      } = error;\n      console.log(data.errors);\n      data.errors && updateErrors(data.errors); // setErrorMsg(JSON.stringify(error.response.data.errors.otp[0]));\n\n      setLoading(false);\n    }\n  };\n\n  const setUsersInput = e => {\n    setUserInput(e.target.value);\n  };\n\n  const onSubmit = async datas => {\n    setLoading(true);\n    setErrorMsg([]);\n\n    try {\n      let values = datas;\n      values.user_id = profile[\"user_id\"];\n      let postData = await resolveBvn(token, values);\n      const {\n        message,\n        data,\n        success\n      } = postData;\n\n      if (success === false) {\n        let msg = [];\n        msg.push(message);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      }\n\n      let mobile = data.mobile.split(\"\");\n      let phone = \", xxx-xxx-xxx-\" + mobile[9] + mobile[10];\n      let Displaymessage = message + \" \" + phone;\n      setOtpRequestId(data.otprequestid);\n      setLoading(false);\n      setDisplayMsg(Displaymessage);\n      setBvnDisabled(true);\n    } catch (error) {\n      // let msg = [] as any;\n      //   msg.push(error.response.data.message);\n      // setErrorMsg(msg);\n      setLoading(false);\n\n      if (error && error.response.status == 500) {\n        let msg = [];\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n\n      if (!error.response) {\n        let msg = [];\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n\n      const {\n        response: {\n          data\n        }\n      } = error;\n      console.log(data.errors);\n      data.errors && updateErrors(data.errors);\n      setLoading(false);\n    }\n  }; // console.log(errorMsg);\n\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"hidden md:block w-5/12 mb-6 border-r-2 border-gray-200\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(OnboardingSideBar, {\n    name: \"bvn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full md:w-7/12 mb-6 px-8 relative\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"block text-gray-700 text-lg font-bold mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 9\n    }\n  }, \"BVN DETAILS\"), errorMsg.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md my-5\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"fill-current h-6 w-6 text-red-500 mr-4\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    style: {\n      listStyleType: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 17\n    }\n  }, errorMsg.map((error, i) => /*#__PURE__*/React.createElement(\"li\", {\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 21\n    }\n  }, error)))))) : \"\", otpMsg ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"fill-current h-6 w-6 text-teal-500 mr-4\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }\n  }, otpMsg)))) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h3\", {\n    className: displayMsg ? \"text-green-700 text-sm font-semibold\" : \"text-gray-600 text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }\n  }, displayMsg ? displayMsg : \"We hate to ask, but regulations mandate us to.\\n Your BVN is safe with us!\", \" \"), /*#__PURE__*/React.createElement(\"form\", {\n    className: \"rounded pt-10\",\n    onSubmit: handleSubmit(onSubmit),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full -mx-3 mb-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-wrap \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"md:w-3/5 px-3 mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 21\n    }\n  }, \"Bank Verification No. (BVN)\"), /*#__PURE__*/React.createElement(\"input\", {\n    className: \"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\",\n    id: \"grid-last-name\",\n    type: \"number\",\n    ref: register({\n      required: true,\n      minLength: 11\n    }),\n    name: \"bvn\",\n    disabled: bvnDisabled,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 21\n    }\n  }), errors.bvn && errors.bvn.type === \"required\" && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-red-500 text-xs italic\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 23\n    }\n  }, \"Please fill out this field.\"), errors.bvn && errors.bvn.type === \"minLength\" && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-red-500 text-xs italic\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 23\n    }\n  }, \"Minimum BVN length is 11.\")), !displayMsg ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \" mb-24 mt-6 bottom-40 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    disabled: loading,\n    className: \"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 25\n    }\n  }, \" Verify BVN \"), !loading ? /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"ml-2\",\n    width: \"18\",\n    height: \"18\",\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 27\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"done_24px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"icon/action/done_24px\",\n    d: \"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\",\n    fill: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 31\n    }\n  }))) : /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/25.gif\",\n    className: \"ml-2\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 27\n    }\n  }))) : \"\"), displayMsg ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex flex-wrap w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"md:w-3/5 px-3 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"otp\",\n    onInput: setUsersInput,\n    className: \"shadow appearance-none border rounded w-full py-3 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",\n    type: \"number\",\n    placeholder: \"Enter the OTP sent to your phone...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: onOtpSubmit,\n    disabled: loading,\n    className: \"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 23\n    }\n  }, \" Validate OTP\"), !loading ? /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"ml-2\",\n    width: \"18\",\n    height: \"18\",\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"done_24px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 27\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"icon/action/done_24px\",\n    d: \"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\",\n    fill: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 29\n    }\n  }))) : /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/25.gif\",\n    className: \"ml-2\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 25\n    }\n  }))) : /*#__PURE__*/React.createElement(React.Fragment, null)))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex justify-end w-full pr-0 md:pr-4 mt-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inline-flex justify-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    disabled: !bvnVerification,\n    onClick: () => pageType === \"onboarding\" ? props.history.push(\"/onboarding/personal\") : props.history.push(\"/profile/personal\"),\n    className: bvnVerification ? \"bg-green-600 hover:bg-green-700 text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded focus:outline-none focus:shadow-outline inline-flex items-center\" : \"bg-gray-400 text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded-r focus:outline-none focus:shadow-outline inline-flex items-center cursor-not-allowed\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 15\n    }\n  }, \" Next \"), /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"ml-2 -mt-1\",\n    width: \"18\",\n    height: \"18\",\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"chevron_right_24px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"icon/navigation/chevron_right_24px\",\n    d: \"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\",\n    fill: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 19\n    }\n  }))))))));\n};\n\nexport default withRouter(Bvn);","map":{"version":3,"sources":["/Users/mac/Documents/react app/agilecreditportal/src/pages/Bvn.tsx"],"names":["React","useState","useQuery","withRouter","OnboardingSideBar","useForm","useProfileStore","resolveBvn","getBvnDetailsFields","completeResolveBVN","useAuthStore","Bvn","props","pageType","location","pathname","includes","loading","setLoading","profile","state","data","displayMsg","setDisplayMsg","errorMsg","setErrorMsg","otpMsg","setOtpMsg","userInput","setUserInput","otpRequestId","setOtpRequestId","bvnDisabled","setBvnDisabled","bvnVerification","setBvnVerification","token","accessToken","isLoading","error","refetch","completed","history","replace","register","setValue","handleSubmit","errors","updateErrors","Object","values","flat","onOtpSubmit","otp","message","success","msg","push","setTimeout","response","status","console","log","setUsersInput","e","target","value","onSubmit","datas","user_id","postData","mobile","split","phone","Displaymessage","otprequestid","length","listStyleType","map","i","required","minLength","bvn","type"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAA6C,OAA7C;AACA,SAASC,QAAT,QAAyB,aAAzB;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,OAAOC,iBAAP,MAA8B,iCAA9B;AACA,SAASC,OAAT,QAAwB,iBAAxB;AAEA,OAAOC,eAAP,MAA4B,wBAA5B;AAEA,SACEC,UADF,EAEEC,mBAFF,EAGEC,kBAHF,QAIO,uBAJP;AAKA,OAAOC,YAAP,MAAyB,qBAAzB;;AAGA,MAAMC,GAAG,GAAIC,KAAD,IAAgB;AAC1B,MAAIC,QAAQ,GAAG,SAAf;;AAEA,MAAID,KAAK,CAACE,QAAN,CAAeC,QAAf,CAAwBC,QAAxB,CAAiC,aAAjC,CAAJ,EAAqD;AACnDH,IAAAA,QAAQ,GAAG,YAAX;AACD;;AAED,QAAM,CAACI,OAAD,EAAUC,UAAV,IAAwBjB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAMkB,OAAO,GAAGb,eAAe,CAAEc,KAAD,IAAWA,KAAK,CAACC,IAAlB,CAA/B;AACA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BtB,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACuB,QAAD,EAAWC,WAAX,IAA0BxB,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACyB,MAAD,EAASC,SAAT,IAAsB1B,QAAQ,CAAC,IAAD,CAApC;AACA,QAAM,CAAC2B,SAAD,EAAYC,YAAZ,IAA4B5B,QAAQ,CAAC,IAAD,CAA1C;AACA,QAAM,CAAC6B,YAAD,EAAeC,eAAf,IAAkC9B,QAAQ,CAAC,IAAD,CAAhD;AACA,QAAM,CAAC+B,WAAD,EAAcC,cAAd,IAAgChC,QAAQ,CAAC,KAAD,CAA9C;AACA,QAAM,CAACiC,eAAD,EAAkBC,kBAAlB,IAAwClC,QAAQ,CAAC,KAAD,CAAtD;AACA,QAAMmC,KAAK,GAAG1B,YAAY,CAAEU,KAAD,IAAWA,KAAK,CAACiB,WAAlB,CAA1B;AAEA,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA,KAAb;AAAoBlB,IAAAA,IAApB;AAA0BmB,IAAAA;AAA1B,MAAsCtC,QAAQ,CAAC,MAAD,EAAS,MAC3DM,mBAAmB,CAAC4B,KAAD,CAD+B,CAApD;;AAIA,MAAIf,IAAI,IAAIA,IAAI,CAAC,CAAD,CAAJ,CAAQoB,SAApB,EAA+B;AAC7B5B,IAAAA,QAAQ,KAAK,YAAb,GACID,KAAK,CAAC8B,OAAN,CAAcC,OAAd,CAAsB,sBAAtB,CADJ,GAEI/B,KAAK,CAAC8B,OAAN,CAAcC,OAAd,CAAsB,mBAAtB,CAFJ;AAGD;;AAED,QAAM;AAAEC,IAAAA,QAAF;AAAYC,IAAAA,QAAZ;AAAsBC,IAAAA,YAAtB;AAAoCC,IAAAA;AAApC,MAA+C1C,OAAO,EAA5D;;AAEA,MAAIiC,SAAJ,EAAe;AACb,wBACE,uDACE;AAAK,MAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AACE,MAAA,GAAG,EAAC,sBADN;AAEE,MAAA,GAAG,EAAC,EAFN;AAGE,MAAA,SAAS,EAAC,oBAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,CADF;AAWD;;AAED,QAAMU,YAAY,GAAID,MAAD,IAAgB;AACnCtB,IAAAA,WAAW,CAACwB,MAAM,CAACC,MAAP,CAAcH,MAAd,EAAsBI,IAAtB,EAAD,CAAX;AACD,GAFD;;AAIA,QAAMC,WAAW,GAAG,YAAY;AAC9B3B,IAAAA,WAAW,CAAC,EAAD,CAAX;AACAP,IAAAA,UAAU,CAAC,IAAD,CAAV;;AACA,QAAI;AACF,UAAImC,GAAG,GAAG,EAAV;AACAA,MAAAA,GAAG,CAAC,KAAD,CAAH,GAAazB,SAAb;AACAyB,MAAAA,GAAG,CAAC,WAAD,CAAH,GAAmBvB,YAAnB;AACAuB,MAAAA,GAAG,CAAC,SAAD,CAAH,GAAiBlC,OAAO,CAAC,SAAD,CAAxB;AACA,YAAM;AAAEmC,QAAAA,OAAF;AAAWjC,QAAAA,IAAX;AAAiBkC,QAAAA;AAAjB,UAA6B,MAAM9C,kBAAkB,CAAC2B,KAAD,EAAQiB,GAAR,CAA3D;;AAEA,UAAIE,OAAO,KAAK,KAAhB,EAAuB;AACrB,YAAIC,GAAG,GAAG,EAAV;AACAA,QAAAA,GAAG,CAACC,IAAJ,CAASH,OAAT;AACA7B,QAAAA,WAAW,CAAC+B,GAAD,CAAX;AACAtC,QAAAA,UAAU,CAAC,KAAD,CAAV;AACA;AACD;;AACDO,MAAAA,WAAW,CAAC,EAAD,CAAX;AACAE,MAAAA,SAAS,CAAC2B,OAAD,CAAT;AACAI,MAAAA,UAAU,CAAC,YAAY;AACrBxC,QAAAA,UAAU,CAAC,KAAD,CAAV;AACAsB,QAAAA,OAAO;AACP3B,QAAAA,QAAQ,KAAK,YAAb,GACID,KAAK,CAAC8B,OAAN,CAAce,IAAd,CAAmB,sBAAnB,CADJ,GAEI7C,KAAK,CAAC8B,OAAN,CAAce,IAAd,CAAmB,mBAAnB,CAFJ;AAGD,OANS,EAMP,IANO,CAAV;AAOAvC,MAAAA,UAAU,CAAC,KAAD,CAAV;AACAiB,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACD,KAzBD,CAyBE,OAAOI,KAAP,EAAc;AACdrB,MAAAA,UAAU,CAAC,KAAD,CAAV;;AACA,UAAIqB,KAAK,IAAIA,KAAK,CAACoB,QAAN,CAAeC,MAAf,IAAyB,GAAtC,EAA2C;AACzC,YAAIJ,GAAG,GAAG,EAAV;AACAA,QAAAA,GAAG,CAACC,IAAJ,CAASlB,KAAK,CAACoB,QAAN,CAAetC,IAAf,CAAoBiC,OAA7B;AACA7B,QAAAA,WAAW,CAAC+B,GAAD,CAAX;AACA;AACD;;AACD,UAAI,CAACjB,KAAK,CAACoB,QAAX,EAAqB;AACnB,YAAIH,GAAG,GAAG,EAAV;AACAA,QAAAA,GAAG,CAACC,IAAJ,CAAS,+CAAT;AACAhC,QAAAA,WAAW,CAAC+B,GAAD,CAAX;AACA;AACD;;AACD,YAAM;AACJG,QAAAA,QAAQ,EAAE;AAAEtC,UAAAA;AAAF;AADN,UAEFkB,KAFJ;AAGAsB,MAAAA,OAAO,CAACC,GAAR,CAAYzC,IAAI,CAAC0B,MAAjB;AACA1B,MAAAA,IAAI,CAAC0B,MAAL,IAAeC,YAAY,CAAC3B,IAAI,CAAC0B,MAAN,CAA3B,CAlBc,CAmBd;;AACA7B,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF,GAlDD;;AAoDA,QAAM6C,aAAa,GAAIC,CAAD,IAAY;AAChCnC,IAAAA,YAAY,CAACmC,CAAC,CAACC,MAAF,CAASC,KAAV,CAAZ;AACD,GAFD;;AAIA,QAAMC,QAAQ,GAAG,MAAOC,KAAP,IAAsB;AACrClD,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAO,IAAAA,WAAW,CAAC,EAAD,CAAX;;AAEA,QAAI;AACF,UAAIyB,MAAM,GAAGkB,KAAb;AACAlB,MAAAA,MAAM,CAACmB,OAAP,GAAiBlD,OAAO,CAAC,SAAD,CAAxB;AACA,UAAImD,QAAQ,GAAG,MAAM/D,UAAU,CAAC6B,KAAD,EAAQc,MAAR,CAA/B;AACA,YAAM;AAAEI,QAAAA,OAAF;AAAWjC,QAAAA,IAAX;AAAiBkC,QAAAA;AAAjB,UAA6Be,QAAnC;;AAEA,UAAIf,OAAO,KAAK,KAAhB,EAAuB;AACrB,YAAIC,GAAG,GAAG,EAAV;AACAA,QAAAA,GAAG,CAACC,IAAJ,CAASH,OAAT;AACA7B,QAAAA,WAAW,CAAC+B,GAAD,CAAX;AACAtC,QAAAA,UAAU,CAAC,KAAD,CAAV;AACA;AACD;;AAED,UAAIqD,MAAM,GAAGlD,IAAI,CAACkD,MAAL,CAAYC,KAAZ,CAAkB,EAAlB,CAAb;AACA,UAAIC,KAAK,GAAG,mBAAmBF,MAAM,CAAC,CAAD,CAAzB,GAA+BA,MAAM,CAAC,EAAD,CAAjD;AACA,UAAIG,cAAc,GAAGpB,OAAO,GAAG,GAAV,GAAgBmB,KAArC;AAEA1C,MAAAA,eAAe,CAACV,IAAI,CAACsD,YAAN,CAAf;AACAzD,MAAAA,UAAU,CAAC,KAAD,CAAV;AACAK,MAAAA,aAAa,CAACmD,cAAD,CAAb;AACAzC,MAAAA,cAAc,CAAC,IAAD,CAAd;AACD,KAtBD,CAsBE,OAAOM,KAAP,EAAc;AACd;AACA;AACA;AACArB,MAAAA,UAAU,CAAC,KAAD,CAAV;;AACA,UAAIqB,KAAK,IAAIA,KAAK,CAACoB,QAAN,CAAeC,MAAf,IAAyB,GAAtC,EAA2C;AACzC,YAAIJ,GAAG,GAAG,EAAV;AACAA,QAAAA,GAAG,CAACC,IAAJ,CAASlB,KAAK,CAACoB,QAAN,CAAetC,IAAf,CAAoBiC,OAA7B;AACA7B,QAAAA,WAAW,CAAC+B,GAAD,CAAX;AACA;AACD;;AACD,UAAI,CAACjB,KAAK,CAACoB,QAAX,EAAqB;AACnB,YAAIH,GAAG,GAAG,EAAV;AACAA,QAAAA,GAAG,CAACC,IAAJ,CAAS,+CAAT;AACAhC,QAAAA,WAAW,CAAC+B,GAAD,CAAX;AACA;AACD;;AACD,YAAM;AACJG,QAAAA,QAAQ,EAAE;AAAEtC,UAAAA;AAAF;AADN,UAEFkB,KAFJ;AAGAsB,MAAAA,OAAO,CAACC,GAAR,CAAYzC,IAAI,CAAC0B,MAAjB;AACA1B,MAAAA,IAAI,CAAC0B,MAAL,IAAeC,YAAY,CAAC3B,IAAI,CAAC0B,MAAN,CAA3B;AACA7B,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF,GAlDD,CAxG0B,CA2J1B;;;AAEA,sBACE,uDACE;AAAK,IAAA,SAAS,EAAC,wDAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,iBAAD;AAAmB,IAAA,IAAI,EAAC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eAKE;AAAK,IAAA,SAAS,EAAC,qCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,SAAS,EAAC,4CAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,EAIGM,QAAQ,CAACoD,MAAT,gBACC;AACE,IAAA,SAAS,EAAC,sFADZ;AAEE,IAAA,IAAI,EAAC,OAFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAIE;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,SAAS,EAAC,wCADZ;AAEE,IAAA,KAAK,EAAC,4BAFR;AAGE,IAAA,OAAO,EAAC,WAHV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKE;AAAM,IAAA,CAAC,EAAC,gJAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,CADF,CADF,eAUE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAI,IAAA,KAAK,EAAE;AAAEC,MAAAA,aAAa,EAAE;AAAjB,KAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGrD,QAAQ,CAACsD,GAAT,CAAa,CAACvC,KAAD,EAAQwC,CAAR,kBACZ;AAAI,IAAA,GAAG,EAAEA,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAaxC,KAAb,CADD,CADH,CADF,CAVF,CAJF,CADD,GAyBC,EA7BJ,EA+BGb,MAAM,gBACL;AACE,IAAA,SAAS,EAAC,4FADZ;AAEE,IAAA,IAAI,EAAC,OAFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAIE;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,SAAS,EAAC,yCADZ;AAEE,IAAA,KAAK,EAAC,4BAFR;AAGE,IAAA,OAAO,EAAC,WAHV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKE;AAAM,IAAA,CAAC,EAAC,gJAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALF,CADF,CADF,eAUE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAG,IAAA,SAAS,EAAC,SAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAwBA,MAAxB,CADF,CAVF,CAJF,CADK,gBAqBL,uDACE;AACE,IAAA,SAAS,EACPJ,UAAU,GACN,sCADM,GAEN,uBAJR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOGA,UAAU,GACPA,UADO,GAEP,4EATN,EASoF,GATpF,CADF,eAYE;AAAM,IAAA,SAAS,EAAC,eAAhB;AAAgC,IAAA,QAAQ,EAAEwB,YAAY,CAACqB,QAAD,CAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAO,IAAA,SAAS,EAAC,oEAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCADF,eAIE;AACE,IAAA,SAAS,EAAC,uKADZ;AAEE,IAAA,EAAE,EAAC,gBAFL;AAGE,IAAA,IAAI,EAAC,QAHP;AAIE,IAAA,GAAG,EAAEvB,QAAQ,CAAC;AAAEoC,MAAAA,QAAQ,EAAE,IAAZ;AAAkBC,MAAAA,SAAS,EAAE;AAA7B,KAAD,CAJf;AAKE,IAAA,IAAI,EAAC,KALP;AAME,IAAA,QAAQ,EAAEjD,WANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,EAYGe,MAAM,CAACmC,GAAP,IAAcnC,MAAM,CAACmC,GAAP,CAAWC,IAAX,KAAoB,UAAlC,iBACC;AAAG,IAAA,SAAS,EAAC,6BAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAbJ,EAiBGpC,MAAM,CAACmC,GAAP,IAAcnC,MAAM,CAACmC,GAAP,CAAWC,IAAX,KAAoB,WAAlC,iBACC;AAAG,IAAA,SAAS,EAAC,6BAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAlBJ,CADF,EAwCG,CAAC7D,UAAD,gBACC;AAAK,IAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,QAAQ,EAAEL,OADZ;AAEE,IAAA,SAAS,EAAC,iJAFZ;AAGE,IAAA,IAAI,EAAC,QAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBALF,EAMG,CAACA,OAAD,gBACC;AACE,IAAA,SAAS,EAAC,MADZ;AAEE,IAAA,KAAK,EAAC,IAFR;AAGE,IAAA,MAAM,EAAC,IAHT;AAIE,IAAA,OAAO,EAAC,WAJV;AAKE,IAAA,IAAI,EAAC,MALP;AAME,IAAA,KAAK,EAAC,4BANR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAQE;AAAG,IAAA,EAAE,EAAC,WAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,EAAE,EAAC,uBADL;AAEE,IAAA,CAAC,EAAC,mGAFJ;AAGE,IAAA,IAAI,EAAC,OAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CARF,CADD,gBAkBC;AAAK,IAAA,GAAG,EAAC,aAAT;AAAuB,IAAA,SAAS,EAAC,MAAjC;AAAwC,IAAA,GAAG,EAAC,EAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAxBJ,CADF,CADD,GA+BC,EAvEJ,CADF,EA4EGK,UAAU,gBACT;AAAK,IAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,IAAI,EAAC,KADP;AAEE,IAAA,OAAO,EAAEyC,aAFX;AAGE,IAAA,SAAS,EAAC,4HAHZ;AAIE,IAAA,IAAI,EAAC,QAJP;AAKE,IAAA,WAAW,EAAC,qCALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eAWE;AACE,IAAA,OAAO,EAAEX,WADX;AAEE,IAAA,QAAQ,EAAEnC,OAFZ;AAGE,IAAA,SAAS,EAAC,iJAHZ;AAIE,IAAA,IAAI,EAAC,QAJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBANF,EAOG,CAACA,OAAD,gBACC;AACE,IAAA,SAAS,EAAC,MADZ;AAEE,IAAA,KAAK,EAAC,IAFR;AAGE,IAAA,MAAM,EAAC,IAHT;AAIE,IAAA,OAAO,EAAC,WAJV;AAKE,IAAA,IAAI,EAAC,MALP;AAME,IAAA,KAAK,EAAC,4BANR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAQE;AAAG,IAAA,EAAE,EAAC,WAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,EAAE,EAAC,uBADL;AAEE,IAAA,CAAC,EAAC,mGAFJ;AAGE,IAAA,IAAI,EAAC,OAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CARF,CADD,gBAkBC;AAAK,IAAA,GAAG,EAAC,aAAT;AAAuB,IAAA,SAAS,EAAC,MAAjC;AAAwC,IAAA,GAAG,EAAC,EAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAzBJ,CAXF,CADS,gBA2CT,yCAvHJ,CADF,CAZF,CApDJ,eA+LE;AAAK,IAAA,SAAS,EAAC,4CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAK,IAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAyBE;AACE,IAAA,QAAQ,EAAE,CAACiB,eADb;AAEE,IAAA,OAAO,EAAE,MACPrB,QAAQ,KAAK,YAAb,GACID,KAAK,CAAC8B,OAAN,CAAce,IAAd,CAAmB,sBAAnB,CADJ,GAEI7C,KAAK,CAAC8B,OAAN,CAAce,IAAd,CAAmB,mBAAnB,CALR;AAOE,IAAA,SAAS,EACPvB,eAAe,GACX,kKADW,GAEX,mKAVR;AAYE,IAAA,IAAI,EAAC,QAZP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAcE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAdF,eAeE;AACE,IAAA,SAAS,EAAC,YADZ;AAEE,IAAA,KAAK,EAAC,IAFR;AAGE,IAAA,MAAM,EAAC,IAHT;AAIE,IAAA,OAAO,EAAC,WAJV;AAKE,IAAA,IAAI,EAAC,MALP;AAME,IAAA,KAAK,EAAC,4BANR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAQE;AAAG,IAAA,EAAE,EAAC,oBAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AACE,IAAA,EAAE,EAAC,oCADL;AAEE,IAAA,CAAC,EAAC,mFAFJ;AAGE,IAAA,IAAI,EAAC,OAHP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CARF,CAfF,CAzBF,CADF,CA/LF,CALF,CADF;AA8RD,CA3bD;;AA6bA,eAAe/B,UAAU,CAACQ,GAAD,CAAzB","sourcesContent":["import React, { useState, useCallback } from \"react\";\nimport { useQuery } from \"react-query\";\nimport { withRouter } from \"react-router\";\nimport OnboardingSideBar from \"../components/OnboardingSideBar\";\nimport { useForm } from \"react-hook-form\";\n\nimport useProfileStore from \"../stores/profileStore\";\n\nimport {\n  resolveBvn,\n  getBvnDetailsFields,\n  completeResolveBVN,\n} from \"../clients/onboarding\";\nimport useAuthStore from \"../stores/authStore\";\nimport FormInput from \"../components/FormInput\";\n\nconst Bvn = (props: any) => {\n  let pageType = \"profile\";\n\n  if (props.location.pathname.includes(\"/onboarding\")) {\n    pageType = \"onboarding\";\n  }\n\n  const [loading, setLoading] = useState(false);\n  const profile = useProfileStore((state) => state.data);\n  const [displayMsg, setDisplayMsg] = useState(\"\");\n  const [errorMsg, setErrorMsg] = useState([]);\n  const [otpMsg, setOtpMsg] = useState(null);\n  const [userInput, setUserInput] = useState(null);\n  const [otpRequestId, setOtpRequestId] = useState(null);\n  const [bvnDisabled, setBvnDisabled] = useState(false);\n  const [bvnVerification, setBvnVerification] = useState(false);\n  const token = useAuthStore((state) => state.accessToken);\n\n  const { isLoading, error, data, refetch } = useQuery(\"data\", () =>\n    getBvnDetailsFields(token)\n  );\n\n  if (data && data[0].completed) {\n    pageType === \"onboarding\"\n      ? props.history.replace(\"/onboarding/personal\")\n      : props.history.replace(\"/profile/personal\");\n  }\n\n  const { register, setValue, handleSubmit, errors } = useForm();\n\n  if (isLoading) {\n    return (\n      <>\n        <div className=\"w-full m-auto px-8 relative\">\n          <img\n            src=\"/img/loading-gif.gif\"\n            alt=\"\"\n            className=\"w-1/8 m-auto py-20\"\n          />\n        </div>\n      </>\n    );\n  }\n\n  const updateErrors = (errors: []) => {\n    setErrorMsg(Object.values(errors).flat());\n  };\n\n  const onOtpSubmit = async () => {\n    setErrorMsg([]);\n    setLoading(true);\n    try {\n      let otp = {};\n      otp[\"otp\"] = userInput;\n      otp[\"requestid\"] = otpRequestId;\n      otp[\"user_id\"] = profile[\"user_id\"];\n      const { message, data, success } = await completeResolveBVN(token, otp);\n\n      if (success === false) {\n        let msg = [] as any;\n        msg.push(message);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      }\n      setErrorMsg([]);\n      setOtpMsg(message);\n      setTimeout(function () {\n        setLoading(false);\n        refetch();\n        pageType === \"onboarding\"\n          ? props.history.push(\"/onboarding/personal\")\n          : props.history.push(\"/profile/personal\");\n      }, 2000);\n      setLoading(false);\n      setBvnVerification(true);\n    } catch (error) {\n      setLoading(false);\n      if (error && error.response.status == 500) {\n        let msg = [] as any;\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n      if (!error.response) {\n        let msg = [] as any;\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n      const {\n        response: { data },\n      } = error;\n      console.log(data.errors);\n      data.errors && updateErrors(data.errors);\n      // setErrorMsg(JSON.stringify(error.response.data.errors.otp[0]));\n      setLoading(false);\n    }\n  };\n\n  const setUsersInput = (e: any) => {\n    setUserInput(e.target.value);\n  };\n\n  const onSubmit = async (datas: any) => {\n    setLoading(true);\n    setErrorMsg([]);\n\n    try {\n      let values = datas;\n      values.user_id = profile[\"user_id\"];\n      let postData = await resolveBvn(token, values);\n      const { message, data, success } = postData;\n\n      if (success === false) {\n        let msg = [] as any;\n        msg.push(message);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      }\n\n      let mobile = data.mobile.split(\"\");\n      let phone = \", xxx-xxx-xxx-\" + mobile[9] + mobile[10];\n      let Displaymessage = message + \" \" + phone;\n\n      setOtpRequestId(data.otprequestid);\n      setLoading(false);\n      setDisplayMsg(Displaymessage);\n      setBvnDisabled(true);\n    } catch (error) {\n      // let msg = [] as any;\n      //   msg.push(error.response.data.message);\n      // setErrorMsg(msg);\n      setLoading(false);\n      if (error && error.response.status == 500) {\n        let msg = [] as any;\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n      if (!error.response) {\n        let msg = [] as any;\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n      const {\n        response: { data },\n      } = error;\n      console.log(data.errors);\n      data.errors && updateErrors(data.errors);\n      setLoading(false);\n    }\n  };\n  // console.log(errorMsg);\n\n  return (\n    <>\n      <div className=\"hidden md:block w-5/12 mb-6 border-r-2 border-gray-200\">\n        <OnboardingSideBar name=\"bvn\" />\n      </div>\n\n      <div className=\"w-full md:w-7/12 mb-6 px-8 relative\">\n        <h1 className=\"block text-gray-700 text-lg font-bold mb-2\">\n          BVN DETAILS\n        </h1>\n        {errorMsg.length ? (\n          <div\n            className=\"bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md my-5\"\n            role=\"alert\"\n          >\n            <div className=\"flex\">\n              <div className=\"py-1\">\n                <svg\n                  className=\"fill-current h-6 w-6 text-red-500 mr-4\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  viewBox=\"0 0 20 20\"\n                >\n                  <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n                </svg>\n              </div>\n              <div>\n                <ul style={{ listStyleType: \"none\" }}>\n                  {errorMsg.map((error, i) => (\n                    <li key={i}>{error}</li>\n                  ))}\n                </ul>\n              </div>\n            </div>\n          </div>\n        ) : (\n          \"\"\n        )}\n        {otpMsg ? (\n          <div\n            className=\"bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\"\n            role=\"alert\"\n          >\n            <div className=\"flex\">\n              <div className=\"py-1\">\n                <svg\n                  className=\"fill-current h-6 w-6 text-teal-500 mr-4\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  viewBox=\"0 0 20 20\"\n                >\n                  <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n                </svg>\n              </div>\n              <div>\n                <p className=\"text-sm\">{otpMsg}</p>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <>\n            <h3\n              className={\n                displayMsg\n                  ? \"text-green-700 text-sm font-semibold\"\n                  : \"text-gray-600 text-sm\"\n              }\n            >\n              {displayMsg\n                ? displayMsg\n                : \"We hate to ask, but regulations mandate us to.\\n Your BVN is safe with us!\"}{\" \"}\n            </h3>\n            <form className=\"rounded pt-10\" onSubmit={handleSubmit(onSubmit)}>\n              <div className=\"w-full -mx-3 mb-6\">\n                <div className=\"flex flex-wrap \">\n                  <div className=\"md:w-3/5 px-3 mb-3\">\n                    <label className=\"block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2\">\n                      Bank Verification No. (BVN)\n                    </label>\n                    <input\n                      className=\"appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\"\n                      id=\"grid-last-name\"\n                      type=\"number\"\n                      ref={register({ required: true, minLength: 11 })}\n                      name=\"bvn\"\n                      disabled={bvnDisabled}\n                    />\n                    {errors.bvn && errors.bvn.type === \"required\" && (\n                      <p className=\"text-red-500 text-xs italic\">\n                        Please fill out this field.\n                      </p>\n                    )}\n                    {errors.bvn && errors.bvn.type === \"minLength\" && (\n                      <p className=\"text-red-500 text-xs italic\">\n                        Minimum BVN length is 11.\n                      </p>\n                    )}\n                  </div>\n                  {/* {data &&\n                    data.map((data, key) => {\n                      return (\n                        <FormInput\n                          key={key}\n                          label=\"Bank Verification No. (BVN)\"\n                          name=\"bvn\"\n                          required={data.required}\n                          errors={errors}\n                          register={register}\n                          type={data.type}\n                          options={data.options}\n                          value={null}\n                        />\n                      );\n                    })} */}\n                  {!displayMsg ? (\n                    <div className=\" mb-24 mt-6 bottom-40 \">\n                      <button\n                        disabled={loading}\n                        className=\"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center\"\n                        type=\"submit\"\n                      >\n                        <span> Verify BVN </span>\n                        {!loading ? (\n                          <svg\n                            className=\"ml-2\"\n                            width=\"18\"\n                            height=\"18\"\n                            viewBox=\"0 0 18 18\"\n                            fill=\"none\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                          >\n                            <g id=\"done_24px\">\n                              <path\n                                id=\"icon/action/done_24px\"\n                                d=\"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\"\n                                fill=\"white\"\n                              />\n                            </g>\n                          </svg>\n                        ) : (\n                          <img src=\"/img/25.gif\" className=\"ml-2\" alt=\"\" />\n                        )}\n                      </button>\n                    </div>\n                  ) : (\n                    \"\"\n                  )}\n                </div>\n\n                {displayMsg ? (\n                  <div className=\"flex flex-wrap w-full\">\n                    <div className=\"md:w-3/5 px-3 \">\n                      <input\n                        name=\"otp\"\n                        onInput={setUsersInput}\n                        className=\"shadow appearance-none border rounded w-full py-3 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                        type=\"number\"\n                        placeholder=\"Enter the OTP sent to your phone...\"\n                      />\n                    </div>\n                    {/* <div className=\"flex items-center justify-between  \"> */}\n                    <button\n                      onClick={onOtpSubmit}\n                      disabled={loading}\n                      className=\"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center\"\n                      type=\"button\"\n                    >\n                      <span> Validate OTP</span>\n                      {!loading ? (\n                        <svg\n                          className=\"ml-2\"\n                          width=\"18\"\n                          height=\"18\"\n                          viewBox=\"0 0 18 18\"\n                          fill=\"none\"\n                          xmlns=\"http://www.w3.org/2000/svg\"\n                        >\n                          <g id=\"done_24px\">\n                            <path\n                              id=\"icon/action/done_24px\"\n                              d=\"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\"\n                              fill=\"white\"\n                            />\n                          </g>\n                        </svg>\n                      ) : (\n                        <img src=\"/img/25.gif\" className=\"ml-2\" alt=\"\" />\n                      )}\n                    </button>\n                    {/* </div> */}\n                  </div>\n                ) : (\n                  <></>\n                )}\n              </div>\n            </form>\n          </>\n        )}\n\n        <div className=\"flex justify-end w-full pr-0 md:pr-4 mt-10\">\n          <div className=\"inline-flex justify-end\">\n            {/* <button\n              onClick={() => props.history.goBack()}\n              className=\"bg-gray-500 hover:bg-gray-600 text-white text-xl font-light py-3 px-8 rounded-l focus:outline-none focus:shadow-outline inline-flex items-center\" \n              type=\"button\"\n            >\n              <svg\n                className=\"mr-2 -mt-1\"\n                width=\"18\"\n                height=\"18\"\n                viewBox=\"0 0 18 18\"\n                fill=\"none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <g id=\"chevron_right_24px\">\n                  <path\n                    id=\"icon/navigation/chevron_left_24px\"\n                    d=\"M15.705 16.59L11.125 12L15.705 7.41L14.295 6L8.29498 12L14.295 18L15.705 16.59Z\"\n                    fill=\"white\"\n                  />\n                </g>\n              </svg>\n              <span> Previous </span>\n            </button> */}\n\n            <button\n              disabled={!bvnVerification}\n              onClick={() =>\n                pageType === \"onboarding\"\n                  ? props.history.push(\"/onboarding/personal\")\n                  : props.history.push(\"/profile/personal\")\n              }\n              className={\n                bvnVerification\n                  ? \"bg-green-600 hover:bg-green-700 text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded focus:outline-none focus:shadow-outline inline-flex items-center\"\n                  : \"bg-gray-400 text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded-r focus:outline-none focus:shadow-outline inline-flex items-center cursor-not-allowed\"\n              }\n              type=\"button\"\n            >\n              <span> Next </span>\n              <svg\n                className=\"ml-2 -mt-1\"\n                width=\"18\"\n                height=\"18\"\n                viewBox=\"0 0 18 18\"\n                fill=\"none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <g id=\"chevron_right_24px\">\n                  <path\n                    id=\"icon/navigation/chevron_right_24px\"\n                    d=\"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\"\n                    fill=\"white\"\n                  />\n                </g>\n              </svg>\n            </button>\n          </div>\n        </div>\n        {/* <div className=\"absolute bottom-0 right-0 mr-16 mt-10\">\n          <button\n            disabled={!bvnVerification}\n            onClick={() => props.history.push(\"/onboarding/personal\")}\n            className={bvnVerification ? \"bg-green-400 hover:bg-green-600 text-white text-xl font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center\" : \"bg-gray-400 text-white text-xl font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center cursor-not-allowed\"}\n            type=\"button\"\n          >\n            <span> Next </span>\n            <svg\n              className=\"ml-2 -mt-1\"\n              width=\"18\"\n              height=\"18\"\n              viewBox=\"0 0 18 18\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <g id=\"chevron_right_24px\">\n                <path\n                  id=\"icon/navigation/chevron_right_24px\"\n                  d=\"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\"\n                  fill=\"white\"\n                />\n              </g>\n            </svg>\n          </button>\n        </div> */}\n      </div>\n    </>\n  );\n};\n\nexport default withRouter(Bvn);\n"]},"metadata":{},"sourceType":"module"}