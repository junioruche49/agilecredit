{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/react app/agilecreditportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/react app/agilecreditportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/react app/agilecreditportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{withRouter}from\"react-router\";import ScheduleCalculator from\"../components/LoanSchedule/ScheduleCalculator\";import{sendLoanApplication}from\"../clients/loan\";import useAuthStore from\"../stores/authStore\";var LoanSchedule=function LoanSchedule(props){var loanData=props.location.loanData;if(loanData===null||loanData===\"\"||loanData===undefined){props.history.push('/new-loan-request');}else{loanData=props.location.loanData;}var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isScheduleVisible=_useState2[0],setIsScheduleVisible=_useState2[1];var token=useAuthStore(function(state){return state.accessToken;});var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setLoading=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),errorMsg=_useState6[0],setErrorMsg=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),responseData=_useState8[0],setResponse=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),submitted=_useState10[0],setSubmitted=_useState10[1];var updateErrors=function updateErrors(errors){setErrorMsg(Object.values(errors).flat());};var postLoan=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var values,_yield$sendLoanApplic,message,data,success,msg,_msg,_msg2,_data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:values={product_code:loanData.no,loan_amount:loanData.loan_amount,number_of_repayments:loanData.no_of_repayments};setLoading(true);_context.prev=2;_context.next=5;return sendLoanApplication(token,values);case 5:_yield$sendLoanApplic=_context.sent;message=_yield$sendLoanApplic.message;data=_yield$sendLoanApplic.data;success=_yield$sendLoanApplic.success;if(!(success===false)){_context.next=15;break;}msg=[];msg.push(message);setErrorMsg(msg);setLoading(false);return _context.abrupt(\"return\");case 15:setSubmitted(true);setTimeout(function(){setSubmitted(false);props.history.replace(\"/applications\");},5000);setResponse(message);setErrorMsg([]);setLoading(false);_context.next=37;break;case 22:_context.prev=22;_context.t0=_context[\"catch\"](2);setLoading(false);if(!(_context.t0&&!_context.t0.response)){_context.next=30;break;}_msg=[];_msg.push(\"Network Error, Check Your Internet Connection\");setErrorMsg(_msg);return _context.abrupt(\"return\");case 30:if(!(_context.t0&&_context.t0.response.status===500)){_context.next=35;break;}_msg2=[];_msg2.push(_context.t0.response.data.message);setErrorMsg(_msg2);return _context.abrupt(\"return\");case 35:_data=_context.t0.response.data;_data.errors&&updateErrors(_data.errors);case 37:case\"end\":return _context.stop();}}},_callee,null,[[2,22]]);}));return function postLoan(){return _ref.apply(this,arguments);};}();if(isLoading){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"w-11/12 bg-white rounded py-12 shadow-lg m-auto px-8 relative\"},/*#__PURE__*/React.createElement(\"img\",{src:\"/img/loading-gif.gif\",alt:\"\",className:\"w-1/8 m-auto py-10\"}),/*#__PURE__*/React.createElement(\"h6\",{className:\"m-auto text-lg text-gray-700 text-center\"},\"Please wait while your application is being submitted...\")));}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"main\",{className:\"md:pl-12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex \"},/*#__PURE__*/React.createElement(\"div\",{className:\"w-full \"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center mt-10 lg:mt-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"w-8 h-1 bg-blue-700 rounded mr-0 hidden md:block\"}),/*#__PURE__*/React.createElement(\"h4\",{className:\"bg-blue-700 md:bg-transparent text-white md:text-gray-700 font-normal md:font-semibold text-md md:text-xl tracking-wide uppercase md:normal-case py-2 px-6 rounded-r-lg\"},\"Loan Schedule\")),/*#__PURE__*/React.createElement(\"br\",null),errorMsg.length?/*#__PURE__*/React.createElement(\"div\",{className:\"w-11/12 bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md mb-5\",role:\"alert\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-1\"},/*#__PURE__*/React.createElement(\"svg\",{className:\"fill-current h-6 w-6 text-red-500 mr-4\",xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 20 20\"},/*#__PURE__*/React.createElement(\"path\",{d:\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\"}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"ul\",{style:{listStyleType:\"none\"}},errorMsg.map(function(error,i){return/*#__PURE__*/React.createElement(\"li\",{key:i},error);}))))):\"\",submitted?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"w-11/12 bg-white rounded py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"w-9/12 bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md mb-5 m-auto fade-in\",role:\"alert\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-1\"},/*#__PURE__*/React.createElement(\"svg\",{className:\"fill-current h-6 w-6 text-teal-500 mr-4\",xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 20 20\"},/*#__PURE__*/React.createElement(\"path\",{d:\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\"}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"font-bold\"},\"Application successful\"),/*#__PURE__*/React.createElement(\"p\",{className:\"text-sm\"},responseData,\". You will be notified of updates concerning your application.\")))),/*#__PURE__*/React.createElement(\"div\",{className:\"w-9/12 m-auto px-8 relative\"},/*#__PURE__*/React.createElement(\"img\",{src:\"/img/message-posted.svg\",alt:\"\",className:\"w-2/4 md:w-1/4 m-auto py-8\"})))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"w-11/12 bg-white flex rounded py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0\"},/*#__PURE__*/React.createElement(\"div\",{className:isScheduleVisible?\"hidden\":\"hidden md:block w-5/12 mb-6 border-r-2 border-gray-300 px-4\"},/*#__PURE__*/React.createElement(\"img\",{src:\"/img/loan-schedule-img.svg\",alt:\"\",className:\"w-9/12 m-auto pt-16 pb-4\"}),/*#__PURE__*/React.createElement(\"h1\",{className:\"w-10/12 m-auto text-center text-blue-800 text-lg font-bold mb-2\"},\"Your cash is closer than you think\")),/*#__PURE__*/React.createElement(\"div\",{className:isScheduleVisible?\"md:w-11/12 w-full mb-6 sm:pl-16 pl-6 py-6 relative\":\"md:w-7/12 w-full mb-6 sm:pl-16 pl-6 py-6 relative\"},isScheduleVisible?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"h1\",{className:\"block text-blue-800 text-lg font-bold mb-6\"},\"Your repayment schedule:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"w-full\"},/*#__PURE__*/React.createElement(ScheduleCalculator,{type:loanData.interest_calculation_method,data:{amount:loanData.loan_amount,rate:loanData.interest_percent,tenor:loanData.no_of_repayments}}))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"h1\",{className:\"block text-blue-800 text-lg font-bold mb-6 fade-in\"},\"Your loan summary:\"),/*#__PURE__*/React.createElement(\"table\",{className:\"table-fixed w-11/12 mb-8 fade-in\"},/*#__PURE__*/React.createElement(\"tbody\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{className:\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\"},\"Type:\"),/*#__PURE__*/React.createElement(\"td\",{className:\"sm:w-4/12 w-1/2 px-4 py-1 text-md text-right font-normal text-gray-700\"},loanData?loanData.description:\"\")),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{className:\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\"},\"Amount:\"),/*#__PURE__*/React.createElement(\"td\",{className:\"sm:w-4/12 w-1/2 px-4 py-1 text-md text-right font-normal text-gray-700\"},loanData?\"\\u20A6\"+Number(loanData.loan_amount).toLocaleString():\"\")),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{className:\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\"},\"Duration:\"),/*#__PURE__*/React.createElement(\"td\",{className:\"w-4/12 px-4 py-1 text-md text-right font-normal text-gray-700\"},loanData?loanData.no_of_repayments:\"\",\" months\")),/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",{className:\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\"},\"Interest Rate:\"),/*#__PURE__*/React.createElement(\"td\",{className:\"w-4/12 px-4 py-1 text-md text-right font-normal text-gray-700\"},loanData?loanData.interest_percent:\"\",\"%\"))))),/*#__PURE__*/React.createElement(\"div\",{className:\"flex justify-end w-11/12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md:inline-flex justify-end pr-4\"},/*#__PURE__*/React.createElement(\"button\",{className:\"bg-gray-300 hover:bg-gray-400 text-gray-600 text-xs font-normal py-3 px-10 rounded-l focus:outline-none focus:shadow-outline inline-flex items-center md:mb-0 mb-5 transition-colors duration-150 ease-in-out\",type:\"button\",onClick:function onClick(){return setIsScheduleVisible(!isScheduleVisible);}},/*#__PURE__*/React.createElement(\"span\",null,\" \",isScheduleVisible?\"View loan summary\":\"View payment schedule\")),/*#__PURE__*/React.createElement(\"button\",{className:\"bg-green-600 hover:bg-green-700 text-white text-sm font-normal py-3 px-10 rounded-r focus:outline-none focus:shadow-outline inline-flex items-center transition-colors duration-150 ease-in-out\",type:\"button\",onClick:postLoan},/*#__PURE__*/React.createElement(\"span\",null,\" Process my loan \"),/*#__PURE__*/React.createElement(\"svg\",{className:\"-mt-1\",width:\"14\",height:\"14\",viewBox:\"0 0 18 18\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\"},/*#__PURE__*/React.createElement(\"g\",{id:\"chevron_right_24px\"},/*#__PURE__*/React.createElement(\"path\",{id:\"icon/navigation/chevron_right_24px\",d:\"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\",fill:\"white\"})))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"w-11/12 mt-8 hidden md:block\"},/*#__PURE__*/React.createElement(\"hr\",{className:\"w-9/12 border-t-2 border-blue-600 bg-blue-400 rounded m-auto\"}))))),/*#__PURE__*/React.createElement(\"br\",null)));};export default withRouter(LoanSchedule);","map":{"version":3,"sources":["/Users/mac/Documents/react app/agilecreditportal/src/pages/LoanSchedule.tsx"],"names":["React","useState","withRouter","ScheduleCalculator","sendLoanApplication","useAuthStore","LoanSchedule","props","loanData","location","undefined","history","push","isScheduleVisible","setIsScheduleVisible","token","state","accessToken","isLoading","setLoading","errorMsg","setErrorMsg","responseData","setResponse","submitted","setSubmitted","updateErrors","errors","Object","values","flat","postLoan","product_code","no","loan_amount","number_of_repayments","no_of_repayments","message","data","success","msg","setTimeout","replace","response","status","length","listStyleType","map","error","i","interest_calculation_method","amount","rate","interest_percent","tenor","description","Number","toLocaleString"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { withRouter } from \"react-router\";\nimport ScheduleCalculator from \"../components/LoanSchedule/ScheduleCalculator\";\nimport {sendLoanApplication} from \"../clients/loan\";\nimport useAuthStore from \"../stores/authStore\";\n\n\n\nconst LoanSchedule = (props: any) =>{\n    let loanData = props.location.loanData\n    if((loanData === null) || (loanData=== \"\") || (loanData === undefined)) {\n        props.history.push('/new-loan-request')\n    }\n    else{\n      loanData = props.location.loanData\n    }\n\n    const [isScheduleVisible, setIsScheduleVisible] = useState(false);\n\n    const token = useAuthStore((state) => state.accessToken);\n\n    const [isLoading, setLoading] = useState(false);\n    const [errorMsg, setErrorMsg] = useState([]);\n    const [responseData, setResponse] = useState(\"\");\n    const [submitted, setSubmitted] = useState(false);\n\n    const updateErrors = (errors: []) => {\n        setErrorMsg(Object.values(errors).flat());\n    };\n\n    const postLoan = async () => {\n        let values = {\n            product_code: loanData.no,\n            loan_amount: loanData.loan_amount,\n            number_of_repayments: loanData.no_of_repayments\n        }\n        setLoading(true)\n        try {\n          const { message, data, success } = await sendLoanApplication(token, values);\n\n            if (success === false) {\n                let msg = [] as any;\n                msg.push(message);\n                setErrorMsg(msg);\n                setLoading(false);\n                return;\n            }\n\n          setSubmitted(true);\n          setTimeout(function () {\n              setSubmitted(false);\n              props.history.replace(\"/applications\");\n            }, 5000);\n          setResponse(message);\n          setErrorMsg([]);\n          setLoading(false);\n        } catch (error) {\n          setLoading(false);\n          if (error && !error.response) {\n            let msg = [] as any;\n            msg.push(\"Network Error, Check Your Internet Connection\");\n            setErrorMsg(msg);\n            return;\n          }\n          if (error && error.response.status === 500) {\n            let msg = [] as any;\n            msg.push(error.response.data.message);\n            setErrorMsg(msg);\n            return;\n          }\n          const {\n            response: { data },\n          } = error;\n          data.errors && updateErrors(data.errors);\n        }\n      };\n\n      if (isLoading) {\n        return (\n          <>\n            <div className=\"w-11/12 bg-white rounded py-12 shadow-lg m-auto px-8 relative\">\n              <img\n                src=\"/img/loading-gif.gif\"\n                alt=\"\"\n                className=\"w-1/8 m-auto py-10\"\n              />\n              <h6 className=\"m-auto text-lg text-gray-700 text-center\">Please wait while your application is being submitted...</h6>\n            </div>\n          </>\n        );\n      }\n\n    return (\n        <>\n        <main className=\"md:pl-12\">\n            <div className=\"flex \">\n                <div className=\"w-full \">\n                    <div className=\"flex items-center mt-10 lg:mt-0\">\n                        <div className=\"w-8 h-1 bg-blue-700 rounded mr-0 hidden md:block\"></div>\n                        <h4 className=\"bg-blue-700 md:bg-transparent text-white md:text-gray-700 font-normal md:font-semibold text-md md:text-xl tracking-wide uppercase md:normal-case py-2 px-6 rounded-r-lg\">\n                            Loan Schedule\n                        </h4>\n                    </div>\n                    <br />\n                    {errorMsg.length ? (\n                        <div\n                            className=\"w-11/12 bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md mb-5\"\n                            role=\"alert\"\n                        >\n                            <div className=\"flex\">\n                            <div className=\"py-1\">\n                                <svg\n                                className=\"fill-current h-6 w-6 text-red-500 mr-4\"\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                viewBox=\"0 0 20 20\"\n                                >\n                                <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n                                </svg>\n                            </div>\n                            <div>\n                                <ul style={{ listStyleType: \"none\" }}>\n                                {errorMsg.map((error, i) => (\n                                    <li key={i}>{error}</li>\n                                ))}\n                                </ul>\n                            </div>\n                            </div>\n                        </div>\n                        ) : (\n                        \"\"\n                        )\n                    }\n                    {submitted ? (\n                        <>\n                            <div className=\"w-11/12 bg-white rounded py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0\">\n                                <div\n                                className=\"w-9/12 bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md mb-5 m-auto fade-in\"\n                                role=\"alert\"\n                                >\n                                    <div className=\"flex\">\n                                        <div className=\"py-1\">\n                                            <svg\n                                                className=\"fill-current h-6 w-6 text-teal-500 mr-4\"\n                                                xmlns=\"http://www.w3.org/2000/svg\"\n                                                viewBox=\"0 0 20 20\"\n                                            >\n                                                <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n                                            </svg>\n                                        </div>\n                                        <div>\n                                            <p className=\"font-bold\">Application successful</p>\n                                            <p className=\"text-sm\">\n                                                {responseData}. You will be notified of updates concerning your application.\n                                            </p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div className=\"w-9/12 m-auto px-8 relative\">\n                                    <img\n                                        src=\"/img/message-posted.svg\"\n                                        alt=\"\"\n                                        className=\"w-2/4 md:w-1/4 m-auto py-8\"\n                                    />\n                                </div>\n                            </div>\n                        </>\n                        ) : \n                        (\n                        <>\n                            <div className=\"w-11/12 bg-white flex rounded py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0\">\n                                <div className={isScheduleVisible ? \"hidden\" : \"hidden md:block w-5/12 mb-6 border-r-2 border-gray-300 px-4\"}>\n                                    <img src=\"/img/loan-schedule-img.svg\" alt=\"\" className=\"w-9/12 m-auto pt-16 pb-4\" />\n                                    <h1 className=\"w-10/12 m-auto text-center text-blue-800 text-lg font-bold mb-2\">\n                                    Your cash is closer than you think\n                                    </h1>\n                                </div>\n                                <div className={isScheduleVisible ? \"md:w-11/12 w-full mb-6 sm:pl-16 pl-6 py-6 relative\" : \"md:w-7/12 w-full mb-6 sm:pl-16 pl-6 py-6 relative\"}>\n                                    {\n                                        isScheduleVisible ?\n                                            <>\n                                                <h1 className=\"block text-blue-800 text-lg font-bold mb-6\">\n                                                    Your repayment schedule:\n                                                </h1>\n                                                <div className=\"w-full\">\n                                                    <ScheduleCalculator type={loanData.interest_calculation_method} data={ {amount: loanData.loan_amount, rate: loanData.interest_percent, tenor: loanData.no_of_repayments} }/>\n                                                </div>\n                                            </>\n                                        :\n                                            <>\n                                                <h1 className=\"block text-blue-800 text-lg font-bold mb-6 fade-in\">\n                                                Your loan summary:\n                                                </h1>\n                                                <table className=\"table-fixed w-11/12 mb-8 fade-in\">  \n                                                    <tbody>\n                                                        <tr>\n                                                            <td className=\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\">Type:</td>\n                                                            <td className=\"sm:w-4/12 w-1/2 px-4 py-1 text-md text-right font-normal text-gray-700\">{loanData ? loanData.description : \"\" }</td>\n                                                        </tr>\n                                                        <tr>\n                                                            <td className=\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\">Amount:</td>\n                                                            <td className=\"sm:w-4/12 w-1/2 px-4 py-1 text-md text-right font-normal text-gray-700\">{loanData ? `â‚¦`+Number(loanData.loan_amount).toLocaleString() : \"\"}</td>\n                                                        </tr>\n                                                        <tr>\n                                                            <td className=\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\">Duration:</td>\n                                                            <td className=\"w-4/12 px-4 py-1 text-md text-right font-normal text-gray-700\">{loanData ? loanData.no_of_repayments: \"\"} months</td>\n                                                        </tr>\n                                                        <tr>\n                                                            <td className=\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\">Interest Rate:</td>\n                                                            <td className=\"w-4/12 px-4 py-1 text-md text-right font-normal text-gray-700\">{loanData ? loanData.interest_percent: \"\"}%</td>\n                                                        </tr>\n                                                        {/* <tr>\n                                                            <td className=\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\">Monthly repayment:</td>\n                                                            <td className=\"w-4/12 px-4 py-1 text-md text-right font-normal text-gray-700\">N14,000</td>\n                                                        </tr>\n                                                        <tr>\n                                                            <td className=\"sm:w-8/12 w-1/2  py-1 text-md font-normal text-gray-700\">Total amount payable:</td>\n                                                            <td className=\"w-4/12 px-4 py-1 text-md text-right font-normal text-gray-700\">N396,000</td>\n                                                        </tr> */}\n                                                    </tbody>\n                                                </table>\n                                            </>\n                                    }\n                                    <div className=\"flex justify-end w-11/12\">\n                                        <div className=\"md:inline-flex justify-end pr-4\">\n                                            <button\n                                            className=\"bg-gray-300 hover:bg-gray-400 text-gray-600 text-xs font-normal py-3 px-10 rounded-l focus:outline-none focus:shadow-outline inline-flex items-center md:mb-0 mb-5 transition-colors duration-150 ease-in-out\"\n                                            type=\"button\"\n                                            onClick={() => setIsScheduleVisible(!isScheduleVisible)} \n                                            >\n                                                <span> { isScheduleVisible ? \"View loan summary\" : \"View payment schedule\" }</span>\n                                            </button>\n                                            <button\n                                            className=\"bg-green-600 hover:bg-green-700 text-white text-sm font-normal py-3 px-10 rounded-r focus:outline-none focus:shadow-outline inline-flex items-center transition-colors duration-150 ease-in-out\"\n                                            type=\"button\"\n                                            onClick={postLoan}\n                                            >\n                                                <span> Process my loan </span>\n                                                <svg\n                                                    className=\"-mt-1\"\n                                                    width=\"14\"\n                                                    height=\"14\"\n                                                    viewBox=\"0 0 18 18\"\n                                                    fill=\"none\"\n                                                    xmlns=\"http://www.w3.org/2000/svg\"\n                                                >\n                                                    <g id=\"chevron_right_24px\">\n                                                    <path\n                                                        id=\"icon/navigation/chevron_right_24px\"\n                                                        d=\"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\"\n                                                        fill=\"white\"\n                                                    />\n                                                    </g>\n                                                </svg>\n                                            </button>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div className=\"w-11/12 mt-8 hidden md:block\">\n                                <hr className=\"w-9/12 border-t-2 border-blue-600 bg-blue-400 rounded m-auto\"></hr>\n                            </div>\n                        </>\n                        )\n                    }\n                    \n                </div>\n            </div>\n            <br />\n        </main>\n        </>\n    )\n}\n\nexport default withRouter(LoanSchedule);"]},"metadata":{},"sourceType":"module"}