{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/Documents/react app/agilecreditportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/Documents/react app/agilecreditportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mac/Documents/react app/agilecreditportal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback}from\"react\";import OnboardingSideBar from\"../components/OnboardingSideBar\";import{useForm}from\"react-hook-form\";import{useQuery}from\"react-query\";import useProfileStore from\"../stores/profileStore\";import{getPersonalDetails}from\"../clients/profile\";import useAuthStore from\"../stores/authStore\";import{getPersonalDetailsFields,patchRequest,getProfileSection}from\"../clients/onboarding\";import FormInput from\"../components/FormInput\";var PersonalDetails=function PersonalDetails(props){var pageType=\"profile\";if(props.location.pathname.includes(\"/onboarding\")){pageType=\"onboarding\";}var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),errorMsg=_useState4[0],setErrorMsg=_useState4[1];var profile=useProfileStore(function(state){return state.data;});var token=useAuthStore(function(state){return state.accessToken;});var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),readonlyValue=_useState6[0],setReadonlyValue=_useState6[1];var _useQuery=useQuery(\"personaldetails\",function(){return getPersonalDetailsFields(token);}),isLoading=_useQuery.isLoading,error=_useQuery.error,data=_useQuery.data;var _useQuery2=useQuery(\"personalDetailssections\",function(){return getProfileSection(token);}),isLoading2=_useQuery2.isLoading,error2=_useQuery2.error,personalDetails=_useQuery2.data,refetch=_useQuery2.refetch;var getUpdatedProfile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var getProfile;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getPersonalDetails(token);case 2:getProfile=_context.sent;initializeProfileStore(getProfile.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getUpdatedProfile(){return _ref.apply(this,arguments);};}();useEffect(function(){getUpdatedProfile();},[]);var initializeProfileStore=useProfileStore(useCallback(function(state){return state.initialize;},[]));var initializeProfileSection=useProfileStore(useCallback(function(state){return state.initializeProfileSection;},[]));useEffect(function(){personalDetails&&initializeProfileSection([].concat(personalDetails),personalDetails.every(function(loan){return loan.completed===true;}));},[personalDetails,initializeProfileSection]);var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.errors,reset=_useForm.reset,control=_useForm.control,unregister=_useForm.unregister;var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),submitted=_useState8[0],setSubmitted=_useState8[1];// console.log(profile[\"user_id\"]);\nif(isLoading||isLoading2){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"w-full m-auto px-8 relative\"},/*#__PURE__*/React.createElement(\"img\",{src:\"/img/loading-gif.gif\",alt:\"\",className:\"w-1/8 m-auto py-20\"})));}var toggleInput=function toggleInput(){setReadonlyValue(function(prev){return!prev;});};var updateErrors=function updateErrors(errors){setErrorMsg(Object.values(errors).flat());};var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values,e){var value,postData,_data,msg,_msg,_data2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:value={};data.map(function(val){value[val.name]=values[val.name];});setLoading(true);_context2.prev=3;_context2.next=6;return patchRequest(token,value);case 6:postData=_context2.sent;e.target.reset();setSubmitted(true);setLoading(false);_data=postData.data;initializeProfileStore(_data);setErrorMsg([]);setTimeout(function(){setSubmitted(false);setLoading(false);refetch();pageType===\"onboarding\"?props.history.push(\"/onboarding/next_of_kin\"):props.history.replace(\"/profile/personal\");},2000);_context2.next=31;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](3);setLoading(false);if(!(_context2.t0&&_context2.t0.response.status===500)){_context2.next=24;break;}msg=[];msg.push(_context2.t0.response.data.message);setErrorMsg(msg);return _context2.abrupt(\"return\");case 24:if(_context2.t0.response){_context2.next=29;break;}_msg=[];_msg.push(\"Network Error, Check Your Internet Connection\");setErrorMsg(_msg);return _context2.abrupt(\"return\");case 29:_data2=_context2.t0.response.data;_data2.errors&&updateErrors(_data2.errors);case 31:case\"end\":return _context2.stop();}}},_callee2,null,[[3,16]]);}));return function onSubmit(_x,_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"hidden md:block w-5/12 mb-6 border-r-2 border-gray-200\"},/*#__PURE__*/React.createElement(OnboardingSideBar,{name:\"personal\"}),/*#__PURE__*/React.createElement(\"img\",{src:\"/img/checklists.svg\",alt:\"\",className:\"w-1/4 m-auto pt-16\"})),/*#__PURE__*/React.createElement(\"div\",{className:\"md:w-7/12 w-full mb-6 px-8 relative\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"block text-gray-700 text-lg font-bold mb-4\"},\"PERSONAL DETAILS\"),errorMsg.length?/*#__PURE__*/React.createElement(\"div\",{className:\"bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md my-5\",role:\"alert\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-1\"},/*#__PURE__*/React.createElement(\"svg\",{className:\"fill-current h-6 w-6 text-red-500 mr-4\",xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 20 20\"},/*#__PURE__*/React.createElement(\"path\",{d:\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\"}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"ul\",{style:{listStyleType:\"none\"}},errorMsg.map(function(error,i){return/*#__PURE__*/React.createElement(\"li\",{key:i},error);}))))):\"\",submitted?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\",role:\"alert\"},/*#__PURE__*/React.createElement(\"div\",{className:\"flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"py-1\"},/*#__PURE__*/React.createElement(\"svg\",{className:\"fill-current h-6 w-6 text-teal-500 mr-4\",xmlns:\"http://www.w3.org/2000/svg\",viewBox:\"0 0 20 20\"},/*#__PURE__*/React.createElement(\"path\",{d:\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\"}))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"font-bold\"},\"Sent successfully\"),/*#__PURE__*/React.createElement(\"p\",{className:\"text-sm\"},\"Personal details created successfully\"))))):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"form\",{className:\"w-full max-w-lg\",onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"div\",{className:\"flex flex-wrap -mx-3 mb-6\"},data&&data.map(function(data,key){return/*#__PURE__*/React.createElement(FormInput,{key:key,label:data.label,name:data.name,required:data.required,errors:errors,register:register,type:data.type,options:data.options,value:profile[data.name],Controller:true,control:true,readonly:data.readonly,readonlyValue:readonlyValue,toggleInput:toggleInput});})),/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center justify-between mt-5 mb-16\"},/*#__PURE__*/React.createElement(\"button\",{className:\"bg-blue-700 hover:bg-blue-800 text-white text-sm md:text-xl font-light py-3 px-10 rounded-lg focus:outline-none focus:shadow-outline inline-flex items-center shadow-lg\",type:\"submit\"},/*#__PURE__*/React.createElement(\"span\",null,\" Save \"),!loading?/*#__PURE__*/React.createElement(\"svg\",{className:\"ml-2\",width:\"13\",height:\"13\",viewBox:\"0 0 18 18\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\"},/*#__PURE__*/React.createElement(\"g\",{id:\"done_24px\"},/*#__PURE__*/React.createElement(\"path\",{id:\"icon/action/done_24px\",d:\"M2 0H14L18 4V16C18 17.1 17.1 18 16 18H2C0.89 18 0 17.1 0 16V2C0 0.9 0.89 0 2 0ZM16 16V4.83L13.17 2H2V16H16ZM9 9C7.34 9 6 10.34 6 12C6 13.66 7.34 15 9 15C10.66 15 12 13.66 12 12C12 10.34 10.66 9 9 9ZM12 3H3V7H12V3Z\",fill:\"white\"}))):/*#__PURE__*/React.createElement(\"img\",{src:\"/img/25.gif\",className:\"ml-2\",alt:\"\"}))))),/*#__PURE__*/React.createElement(\"div\",{className:\"flex justify-end w-full pr-0 md:pr-4 mt-10\"},/*#__PURE__*/React.createElement(\"div\",{className:\"md:inline-flex justify-end\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){return pageType===\"onboarding\"?props.history.push(\"/onboarding/bvn\"):props.history.push(\"/profile/bvn\");},className:\"bg-gray-500 hover:bg-gray-600 text-white text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded-l focus:outline-none focus:shadow-outline inline-flex items-center\",type:\"button\"},/*#__PURE__*/React.createElement(\"svg\",{className:\"mr-2 -mt-1\",width:\"18\",height:\"18\",viewBox:\"0 0 18 18\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\"},/*#__PURE__*/React.createElement(\"g\",{id:\"chevron_right_24px\"},/*#__PURE__*/React.createElement(\"path\",{id:\"icon/navigation/chevron_left_24px\",d:\"M15.705 16.59L11.125 12L15.705 7.41L14.295 6L8.29498 12L14.295 18L15.705 16.59Z\",fill:\"white\"}))),/*#__PURE__*/React.createElement(\"span\",null,\" Previous \")),/*#__PURE__*/React.createElement(\"button\",{// disabled={!submitted}\nonClick:function onClick(){return pageType===\"onboarding\"?props.history.push(\"/onboarding/next_of_kin\"):props.history.push(\"/profile/next_of_kin\");},className:\"bg-green-600 hover:bg-green-700 text-white text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded-r focus:outline-none focus:shadow-outline inline-flex items-center\",type:\"button\"},/*#__PURE__*/React.createElement(\"span\",null,\" Next \"),/*#__PURE__*/React.createElement(\"svg\",{className:\"ml-2 -mt-1\",width:\"18\",height:\"18\",viewBox:\"0 0 18 18\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\"},/*#__PURE__*/React.createElement(\"g\",{id:\"chevron_right_24px\"},/*#__PURE__*/React.createElement(\"path\",{id:\"icon/navigation/chevron_right_24px\",d:\"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\",fill:\"white\"}))))))));};export default PersonalDetails;","map":{"version":3,"sources":["/Users/mac/Documents/react app/agilecreditportal/src/pages/PersonalDetails.tsx"],"names":["React","useState","useEffect","useCallback","OnboardingSideBar","useForm","useQuery","useProfileStore","getPersonalDetails","useAuthStore","getPersonalDetailsFields","patchRequest","getProfileSection","FormInput","PersonalDetails","props","pageType","location","pathname","includes","loading","setLoading","errorMsg","setErrorMsg","profile","state","data","token","accessToken","readonlyValue","setReadonlyValue","isLoading","error","isLoading2","error2","personalDetails","refetch","getUpdatedProfile","getProfile","initializeProfileStore","initialize","initializeProfileSection","concat","every","loan","completed","register","handleSubmit","errors","reset","control","unregister","submitted","setSubmitted","toggleInput","prev","updateErrors","Object","values","flat","onSubmit","e","value","map","val","name","postData","target","setTimeout","history","push","replace","response","status","msg","message","length","listStyleType","i","key","label","required","type","options","readonly"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport OnboardingSideBar from \"../components/OnboardingSideBar\";\nimport { useForm, Controller } from \"react-hook-form\";\n\nimport { useQuery } from \"react-query\";\n\nimport useProfileStore from \"../stores/profileStore\";\nimport { getPersonalDetails } from \"../clients/profile\";\nimport useAuthStore from \"../stores/authStore\";\nimport {\n  getPersonalDetailsFields,\n  patchRequest,\n  getProfileSection,\n} from \"../clients/onboarding\";\nimport FormInput from \"../components/FormInput\";\n\nconst PersonalDetails = (props: any) => {\n  let pageType = \"profile\";\n\n  if (props.location.pathname.includes(\"/onboarding\")) {\n    pageType = \"onboarding\";\n  }\n\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState([]);\n  const profile = useProfileStore((state) => state.data);\n  const token = useAuthStore((state) => state.accessToken);\n  const [readonlyValue, setReadonlyValue] = useState(false);\n  const { isLoading, error, data } = useQuery(\"personaldetails\", () =>\n    getPersonalDetailsFields(token)\n  );\n\n  const {\n    isLoading: isLoading2,\n    error: error2,\n    data: personalDetails,\n    refetch,\n  } = useQuery(\"personalDetailssections\", () => getProfileSection(token));\n\n  const getUpdatedProfile = async () => {\n    let getProfile = await getPersonalDetails(token);\n    initializeProfileStore(getProfile.data);\n  };\n\n  useEffect(() => {\n    getUpdatedProfile();\n  }, []);\n\n  const initializeProfileStore = useProfileStore(\n    useCallback((state) => state.initialize, [])\n  );\n\n  const initializeProfileSection = useProfileStore(\n    useCallback((state) => state.initializeProfileSection, [])\n  );\n\n  useEffect(() => {\n    personalDetails &&\n      initializeProfileSection(\n        [].concat(personalDetails),\n        personalDetails.every((loan) => loan.completed === true)\n      );\n  }, [personalDetails, initializeProfileSection]);\n\n  const {\n    register,\n    handleSubmit,\n    errors,\n    reset,\n    control,\n    unregister,\n  } = useForm();\n  const [submitted, setSubmitted] = useState(false);\n  // console.log(profile[\"user_id\"]);\n\n  if (isLoading || isLoading2) {\n    return (\n      <>\n        <div className=\"w-full m-auto px-8 relative\">\n          <img\n            src=\"/img/loading-gif.gif\"\n            alt=\"\"\n            className=\"w-1/8 m-auto py-20\"\n          />\n        </div>\n      </>\n    );\n  }\n\n  const toggleInput = () => {\n    setReadonlyValue((prev) => !prev);\n  };\n\n  const updateErrors = (errors: []) => {\n    setErrorMsg(Object.values(errors).flat());\n  };\n\n  const onSubmit = async (values: any, e) => {\n    let value = {};\n    data.map((val) => {\n      value[val.name] = values[val.name];\n    });\n    setLoading(true);\n    try {\n      let postData = await patchRequest(token, value);\n      e.target.reset();\n      setSubmitted(true);\n      setLoading(false);\n      const { data } = postData;\n      initializeProfileStore(data);\n      setErrorMsg([]);\n      setTimeout(function () {\n        setSubmitted(false);\n        setLoading(false);\n        refetch();\n        pageType === \"onboarding\"\n          ? props.history.push(\"/onboarding/next_of_kin\")\n          : props.history.replace(\"/profile/personal\");\n      }, 2000);\n    } catch (error) {\n      setLoading(false);\n      if (error && error.response.status === 500) {\n        let msg = [] as any;\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n      if (!error.response) {\n        let msg = [] as any;\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n      const {\n        response: { data },\n      } = error;\n      data.errors && updateErrors(data.errors);\n    }\n  };\n  return (\n    <>\n      <div className=\"hidden md:block w-5/12 mb-6 border-r-2 border-gray-200\">\n        <OnboardingSideBar name=\"personal\" />\n        <img src=\"/img/checklists.svg\" alt=\"\" className=\"w-1/4 m-auto pt-16\" />\n      </div>\n\n      <div className=\"md:w-7/12 w-full mb-6 px-8 relative\">\n        <h1 className=\"block text-gray-700 text-lg font-bold mb-4\">\n          PERSONAL DETAILS\n        </h1>\n        {errorMsg.length ? (\n          <div\n            className=\"bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md my-5\"\n            role=\"alert\"\n          >\n            <div className=\"flex\">\n              <div className=\"py-1\">\n                <svg\n                  className=\"fill-current h-6 w-6 text-red-500 mr-4\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  viewBox=\"0 0 20 20\"\n                >\n                  <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n                </svg>\n              </div>\n              <div>\n                {/* <p className=\"font-bold\">Sent successfully</p> */}\n                {/* <p className=\"text-sm\">{errorMsg}</p> */}\n                <ul style={{ listStyleType: \"none\" }}>\n                  {errorMsg.map((error, i) => (\n                    <li key={i}>{error}</li>\n                  ))}\n                </ul>\n              </div>\n            </div>\n          </div>\n        ) : (\n          \"\"\n        )}\n        {/* <h3 className=\"text-gray-600 text-sm\"> We hate to ask, but regulations mandate us to. <br/> Your BVN is safe with us!</h3> */}\n        {submitted ? (\n          <>\n            <div\n              className=\"bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\"\n              role=\"alert\"\n            >\n              <div className=\"flex\">\n                <div className=\"py-1\">\n                  <svg\n                    className=\"fill-current h-6 w-6 text-teal-500 mr-4\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    viewBox=\"0 0 20 20\"\n                  >\n                    <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n                  </svg>\n                </div>\n                <div>\n                  <p className=\"font-bold\">Sent successfully</p>\n                  <p className=\"text-sm\">\n                    Personal details created successfully\n                  </p>\n                </div>\n              </div>\n            </div>\n          </>\n        ) : (\n          <>\n            <form className=\"w-full max-w-lg\" onSubmit={handleSubmit(onSubmit)}>\n              <div className=\"flex flex-wrap -mx-3 mb-6\">\n                {data &&\n                  data.map((data, key) => {\n                    return (\n                      <FormInput\n                        key={key}\n                        label={data.label}\n                        name={data.name}\n                        required={data.required}\n                        errors={errors}\n                        register={register}\n                        type={data.type}\n                        options={data.options}\n                        value={profile[data.name]}\n                        Controller\n                        control\n                        readonly={data.readonly}\n                        readonlyValue={readonlyValue}\n                        toggleInput={toggleInput}\n                      />\n                    );\n                  })}\n              </div>\n\n              <div className=\"flex items-center justify-between mt-5 mb-16\">\n                <button\n                  className=\"bg-blue-700 hover:bg-blue-800 text-white text-sm md:text-xl font-light py-3 px-10 rounded-lg focus:outline-none focus:shadow-outline inline-flex items-center shadow-lg\"\n                  type=\"submit\"\n                >\n                  <span> Save </span>\n                  {!loading ? (\n                    <svg\n                      className=\"ml-2\"\n                      width=\"13\"\n                      height=\"13\"\n                      viewBox=\"0 0 18 18\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <g id=\"done_24px\">\n                        <path\n                          id=\"icon/action/done_24px\"\n                          d=\"M2 0H14L18 4V16C18 17.1 17.1 18 16 18H2C0.89 18 0 17.1 0 16V2C0 0.9 0.89 0 2 0ZM16 16V4.83L13.17 2H2V16H16ZM9 9C7.34 9 6 10.34 6 12C6 13.66 7.34 15 9 15C10.66 15 12 13.66 12 12C12 10.34 10.66 9 9 9ZM12 3H3V7H12V3Z\"\n                          fill=\"white\"\n                        />\n                      </g>\n                    </svg>\n                  ) : (\n                    <img src=\"/img/25.gif\" className=\"ml-2\" alt=\"\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </>\n        )}\n\n        <div className=\"flex justify-end w-full pr-0 md:pr-4 mt-10\">\n          <div className=\"md:inline-flex justify-end\">\n            <button\n              onClick={() =>\n                pageType === \"onboarding\"\n                  ? props.history.push(\"/onboarding/bvn\")\n                  : props.history.push(\"/profile/bvn\")\n              }\n              className=\"bg-gray-500 hover:bg-gray-600 text-white text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded-l focus:outline-none focus:shadow-outline inline-flex items-center\"\n              type=\"button\"\n            >\n              <svg\n                className=\"mr-2 -mt-1\"\n                width=\"18\"\n                height=\"18\"\n                viewBox=\"0 0 18 18\"\n                fill=\"none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <g id=\"chevron_right_24px\">\n                  <path\n                    id=\"icon/navigation/chevron_left_24px\"\n                    d=\"M15.705 16.59L11.125 12L15.705 7.41L14.295 6L8.29498 12L14.295 18L15.705 16.59Z\"\n                    fill=\"white\"\n                  />\n                </g>\n              </svg>\n              <span> Previous </span>\n            </button>\n\n            <button\n              // disabled={!submitted}\n              onClick={() =>\n                pageType === \"onboarding\"\n                  ? props.history.push(\"/onboarding/next_of_kin\")\n                  : props.history.push(\"/profile/next_of_kin\")\n              }\n              className=\"bg-green-600 hover:bg-green-700 text-white text-md md:text-xl font-light py-3 px-6 md:py-3 md:px-8 rounded-r focus:outline-none focus:shadow-outline inline-flex items-center\"\n              type=\"button\"\n            >\n              <span> Next </span>\n              <svg\n                className=\"ml-2 -mt-1\"\n                width=\"18\"\n                height=\"18\"\n                viewBox=\"0 0 18 18\"\n                fill=\"none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n              >\n                <g id=\"chevron_right_24px\">\n                  <path\n                    id=\"icon/navigation/chevron_right_24px\"\n                    d=\"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\"\n                    fill=\"white\"\n                  />\n                </g>\n              </svg>\n            </button>\n          </div>\n        </div>\n\n        {/* <div className=\"absolute bottom-0 right-0 mr-10 -mt-8\">\n          <button\n            onClick={() => props.history.push(\"/onboarding/next_of_kin\")}\n            className=\"bg-gray-400 hover:bg-gray-600 text-white text-xl font-light py-3 px-10 rounded-lg focus:outline-none focus:shadow-outline inline-flex items-center\"\n            type=\"button\"\n            disabled={!submitted}\n          >\n            <span> Next </span>\n            <svg\n              className=\"ml-2 -mt-1\"\n              width=\"18\"\n              height=\"18\"\n              viewBox=\"0 0 18 18\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <g id=\"chevron_right_24px\">\n                <path\n                  id=\"icon/navigation/chevron_right_24px\"\n                  d=\"M9.70492 6L8.29492 7.41L12.8749 12L8.29492 16.59L9.70492 18L15.7049 12L9.70492 6Z\"\n                  fill=\"white\"\n                />\n              </g>\n            </svg>\n          </button>\n        </div> */}\n      </div>\n    </>\n  );\n};\n\nexport default PersonalDetails;\n"]},"metadata":{},"sourceType":"module"}