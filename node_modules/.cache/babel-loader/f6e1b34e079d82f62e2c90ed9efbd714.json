{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/react app/agilecreditportal/src/pages/PayWithExistingCard.tsx\";\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport useAuthStore from \"../stores/authStore\";\nimport useProfileStore from \"../stores/profileStore\";\nimport { getCards } from \"../clients/cards\";\nimport { withRouter } from \"react-router-dom\";\nimport { sendOtpRequest, payWithExistingCard } from \"../clients/payments\";\n\nconst PayWithExistingCard = props => {\n  const [isLoading, setLoading] = useState(false);\n  const token = useAuthStore(state => state.accessToken);\n  const profile = useProfileStore(useCallback(state => state.data, []));\n  const [cardsReponse, setCardsReponse] = useState();\n  const [responseMessage, setResponseMessage] = useState(null);\n  const [showCardsList, setShowCardsList] = useState(true);\n  const [selectedCard, setSelectedCard] = useState();\n  const [showOtpForm, setShowOtpForm] = useState(false);\n  const [userOtpInput, setUserOtpInput] = useState(null);\n  const [submitting, setSubmitting] = useState(false);\n  const [otpRequestResponseData, setOtpRequestResponseData] = useState();\n  const [otpRequestMessage, setOtpRequestMessage] = useState(null);\n  const [repaymentMessage, setRepaymentMessage] = useState(null);\n  const [errorMsg, setErrorMsg] = useState([]);\n  const amountToPay = props.amount ? Number(props.amount) * 100 : null;\n  const loanId = props.loanId ? props.loanId : null;\n\n  const updateErrors = errors => {\n    setErrorMsg(Object.values(errors).flat());\n  };\n\n  const goToAddCard = () => {\n    props.history.push(\"/cards/add\");\n  };\n\n  const postCardOwner = useCallback(async () => {\n    let values = {\n      email: profile.e_mail\n    };\n    setLoading(true);\n\n    try {\n      const {\n        message,\n        data,\n        success\n      } = await getCards(token, values);\n\n      if (success === false) {\n        let msg = [];\n        msg.push(message);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      } // setResponseMessage(message);\n\n\n      setTimeout(function () {\n        setResponseMessage(null);\n      }, 3000);\n      setCardsReponse(data);\n      setErrorMsg([]);\n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n\n      if (error && !error.response) {\n        let msg = [];\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n\n      if (error && error.response.status === 500) {\n        let msg = [];\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n\n      const {\n        response: {\n          data\n        }\n      } = error;\n      data.errors && updateErrors(data.errors);\n    }\n  }, [token, profile.e_mail]);\n  useEffect(() => {\n    if (profile && profile.e_mail) postCardOwner();\n  }, [profile]);\n\n  const postOtpRequest = async () => {\n    setLoading(true);\n\n    try {\n      const {\n        message: OtpRequestMessage,\n        data: OtpRequestData,\n        status: OtpRequestStatus\n      } = await sendOtpRequest(token);\n\n      if (OtpRequestStatus === false) {\n        let msg = [];\n        msg.push(OtpRequestMessage);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      }\n\n      setOtpRequestMessage(OtpRequestMessage);\n      setShowCardsList(false);\n      setShowOtpForm(true);\n      setTimeout(function () {\n        setOtpRequestMessage(null);\n      }, 4000);\n      setOtpRequestResponseData(OtpRequestData);\n      setErrorMsg([]);\n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n\n      if (error && !error.response) {\n        let msg = [];\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n\n      if (error && error.response.status === 500) {\n        let msg = [];\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n\n      const {\n        response: {\n          data\n        }\n      } = error;\n      data.errors && updateErrors(data.errors);\n    }\n  };\n\n  const submitRepayment = async () => {\n    setSubmitting(true);\n    let values = {\n      otp: userOtpInput,\n      requestid: otpRequestResponseData.otprequestid,\n      amount: amountToPay,\n      payment_type: 2,\n      description: \"On Demand Charge\",\n      card_id: selectedCard,\n      loan_id: loanId\n    };\n\n    try {\n      const {\n        message: repaymentResponseMessage,\n        data: repaymentResponseData,\n        status: repaymentResponseStatus\n      } = await payWithExistingCard(token, values);\n\n      if (repaymentResponseStatus === false) {\n        let msg = [];\n        msg.push(repaymentResponseMessage);\n        setErrorMsg(msg);\n        setSubmitting(false);\n        return;\n      }\n\n      setRepaymentMessage(repaymentResponseMessage);\n      setErrorMsg([]);\n      props.history.replace({\n        pathname: \"/pay/success\",\n        referrerData: {\n          loan_id: loanId\n        }\n      });\n      setSubmitting(false);\n    } catch (error) {\n      setSubmitting(false);\n\n      if (error && !error.response) {\n        let msg = [];\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n\n      if (error && error.response.status === 500) {\n        let msg = [];\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n\n      const {\n        response: {\n          data\n        }\n      } = error;\n      data.errors && updateErrors(data.errors);\n    }\n  };\n\n  const _handleCardSelection = id => {\n    setSelectedCard(id);\n  };\n\n  const _handleAuthorizeToPay = () => {\n    postOtpRequest();\n  };\n\n  const _handleUserOtpInput = e => {\n    setUserOtpInput(e.target.value);\n  };\n\n  if (isLoading || !profile.e_mail) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"/img/loading-gif.gif\",\n      alt: \"\",\n      className: \"w-1/8 m-auto py-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"m-auto text-lg text-gray-700 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }\n    }, \"Please wait while we process your request...\"));\n  }\n\n  if (submitting) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"w-11/12 bg-white rounded py-12 shadow-lg m-auto px-8 relative mt-20\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"/img/loading-gif.gif\",\n      alt: \"\",\n      className: \"w-1/8 m-auto py-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"m-auto text-lg text-gray-700 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 11\n      }\n    }, \"Hold on, while we attempt to charge your card...\")));\n  }\n\n  if (amountToPay === null || loanId === null) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"w-11/12 bg-white rounded py-12 m-auto px-4 relative mt-20\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"/img/error-icon.svg\",\n      alt: \"\",\n      className: \"w-2/4 md:w-1/4 m-auto\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"m-auto text-lg text-red-600 text-center font-semibold mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }\n    }, \"Ooops! The system was unable to capture one or more of your payment data. Please try again!\")));\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, errorMsg.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 m-auto bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md my-5\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"fill-current h-6 w-6 text-red-500 mr-4\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    style: {\n      listStyleType: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 15\n    }\n  }, errorMsg.map((error, i) => /*#__PURE__*/React.createElement(\"li\", {\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 19\n    }\n  }, error)))))) : \"\", responseMessage && (cardsReponse === null || cardsReponse === void 0 ? void 0 : cardsReponse.length) > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 m-auto bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"fill-current h-6 w-6 text-teal-500 mr-4\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 15\n    }\n  }, responseMessage)))) : otpRequestMessage ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 m-auto bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"fill-current h-6 w-6 text-teal-500 mr-4\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 15\n    }\n  }, otpRequestMessage)))) : repaymentMessage ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 m-auto bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"fill-current h-6 w-6 text-teal-500 mr-4\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 15\n    }\n  }, repaymentMessage)))) : null, showOtpForm ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-green-700 font-medium text-center my-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 11\n    }\n  }, \"We have sent a code to your phone. Please enter the code below.\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"md:flex justify-center w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"md:w-3/5 px-3 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"otp\",\n    onInput: _handleUserOtpInput,\n    className: \"shadow appearance-none border rounded w-full py-3 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",\n    type: \"number\",\n    placeholder: \"Enter the OTP sent to your phone...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: submitRepayment,\n    disabled: submitting,\n    className: \"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center justify-center my-3 md:my-0 ml-3\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 15\n    }\n  }, \" Confirm & Pay\"), !submitting ? /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"ml-2\",\n    width: \"18\",\n    height: \"18\",\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"done_24px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"icon/action/done_24px\",\n    d: \"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\",\n    fill: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 21\n    }\n  }))) : /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/25.gif\",\n    className: \"ml-2\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"md:flex justify-center w-full\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"md:w-3/5 px-3 \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 379,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    disabled: submitting,\n    className: \"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center justify-center my-3 md:my-0 ml-3\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 15\n    }\n  }, \" Resend OTP\"), !submitting ? /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"ml-2\",\n    width: \"18\",\n    height: \"18\",\n    viewBox: \"0 0 18 18\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 387,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"done_24px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"icon/action/done_24px\",\n    d: \"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\",\n    fill: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 21\n    }\n  }))) : /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/25.gif\",\n    className: \"ml-2\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 17\n    }\n  })))) : null, showCardsList && (cardsReponse === null || cardsReponse === void 0 ? void 0 : cardsReponse.length) > 0 ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-9/12 m-auto mt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"text-md md:text-xl text-gray-700 text-left font-semibold mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 15\n    }\n  }, \"Select your card:\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"relative w-9/12 m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"w-2 h-2 absolute top-0 right-0 m-4 pointer-events-none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 412 232\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M206 171.144L42.678 7.822c-9.763-9.763-25.592-9.763-35.355 0-9.763 9.764-9.763 25.592 0 35.355l181 181c4.88 4.882 11.279 7.323 17.677 7.323s12.796-2.441 17.678-7.322l181-181c9.763-9.764 9.763-25.592 0-35.355-9.763-9.763-25.592-9.763-35.355 0L206 171.144z\",\n    fill: \"#648299\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"select\", {\n    className: \"w-full border border-gray-300 rounded-full text-gray-600 h-10 pl-5 pr-10 bg-white hover:border-gray-400 focus:outline-none appearance-none m-auto\",\n    onChange: e => _handleCardSelection(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 17\n    }\n  }, \"-- Select a card --\"), cardsReponse && cardsReponse.map((card, key) => {\n    return /*#__PURE__*/React.createElement(\"option\", {\n      key: key,\n      value: card.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 23\n      }\n    }, \"XXXX-\", card.last4, \" - Exp: \", card.exp_month, \"/\", card.exp_year.slice(-2), \" (\", card.card_type.trim(), \")\");\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full m-auto mt-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    disabled: selectedCard ? false : true,\n    onClick: _handleAuthorizeToPay,\n    className: !selectedCard ? \"flex w-2/4 md:w-1/4 text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-gray-200 rounded-md m-auto cursor-not-allowed\" : \"flex w-2/4 md:w-1/4 shadow-xl text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-green-600 hover:bg-green-700 rounded-md m-auto transition-colors duration-150 ease-in-out\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-sm xl:text-lg lg:text-sm pr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 17\n    }\n  }, \"Proceed\"), /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/chevron-right.svg\",\n    className: \"w-5 pt-1\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 17\n    }\n  }))))) : showCardsList && (cardsReponse === null || cardsReponse === void 0 ? void 0 : cardsReponse.length) === 0 ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full m-auto mb-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/check-files.svg\",\n    alt: \"\",\n    className: \"w-3/4 md:w-2/4 m-auto opacity-50\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-3/4 m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-700 font-medium text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 13\n    }\n  }, \"We found no cards on your profile. Please add a card!\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex justify-center items-center h-16 my-2 md:my-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"flex bg-blue-200 hover:bg-blue-300 items-center py-2 px-4 rounded-lg transition-colors duration-150 ease-in-out cursor-pointer\",\n    onClick: goToAddCard,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    width: \"24\",\n    height: \"25\",\n    viewBox: \"0 0 24 25\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"add_24px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"icon/content/add_24px\",\n    d: \"M19 13.3832H13V19.229H11V13.3832H5V11.4346H11V5.58878H13V11.4346H19V13.3832Z\",\n    fill: \"#0A54A2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 21\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ml-2 text-blue-700 text-md\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 15\n    }\n  }, \"Add Card\")))) : null);\n};\n\nexport default withRouter(PayWithExistingCard);","map":{"version":3,"sources":["/Users/mac/Documents/react app/agilecreditportal/src/pages/PayWithExistingCard.tsx"],"names":["React","useState","useCallback","useEffect","useAuthStore","useProfileStore","getCards","withRouter","sendOtpRequest","payWithExistingCard","PayWithExistingCard","props","isLoading","setLoading","token","state","accessToken","profile","data","cardsReponse","setCardsReponse","responseMessage","setResponseMessage","showCardsList","setShowCardsList","selectedCard","setSelectedCard","showOtpForm","setShowOtpForm","userOtpInput","setUserOtpInput","submitting","setSubmitting","otpRequestResponseData","setOtpRequestResponseData","otpRequestMessage","setOtpRequestMessage","repaymentMessage","setRepaymentMessage","errorMsg","setErrorMsg","amountToPay","amount","Number","loanId","updateErrors","errors","Object","values","flat","goToAddCard","history","push","postCardOwner","email","e_mail","message","success","msg","setTimeout","error","response","status","postOtpRequest","OtpRequestMessage","OtpRequestData","OtpRequestStatus","submitRepayment","otp","requestid","otprequestid","payment_type","description","card_id","loan_id","repaymentResponseMessage","repaymentResponseData","repaymentResponseStatus","replace","pathname","referrerData","_handleCardSelection","id","_handleAuthorizeToPay","_handleUserOtpInput","e","target","value","length","listStyleType","map","i","card","key","last4","exp_month","exp_year","slice","card_type","trim"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from \"react\";\nimport useAuthStore from \"../stores/authStore\";\nimport useProfileStore from \"../stores/profileStore\";\nimport { getCards } from \"../clients/cards\";\nimport { withRouter } from \"react-router-dom\";\nimport { sendOtpRequest, payWithExistingCard } from \"../clients/payments\";\n\nconst PayWithExistingCard = (props: any) => {\n  const [isLoading, setLoading] = useState(false);\n\n  const token = useAuthStore((state) => state.accessToken);\n  const profile: any = useProfileStore(useCallback((state) => state.data, []));\n  const [cardsReponse, setCardsReponse]: any = useState();\n  const [responseMessage, setResponseMessage]: any = useState(null);\n  const [showCardsList, setShowCardsList]: any = useState(true);\n  const [selectedCard, setSelectedCard] = useState<any>();\n  const [showOtpForm, setShowOtpForm]: any = useState(false);\n  const [userOtpInput, setUserOtpInput] = useState(null);\n  const [submitting, setSubmitting]: any = useState(false);\n  const [otpRequestResponseData, setOtpRequestResponseData]: any = useState();\n  const [otpRequestMessage, setOtpRequestMessage]: any = useState(null);\n  const [repaymentMessage, setRepaymentMessage]: any = useState(null);\n\n  const [errorMsg, setErrorMsg] = useState([]);\n\n  const amountToPay = props.amount ? Number(props.amount) * 100 : null;\n  const loanId = props.loanId ? props.loanId : null;\n\n  const updateErrors = (errors: []) => {\n    setErrorMsg(Object.values(errors).flat());\n  };\n\n  const goToAddCard = () => {\n    props.history.push(\"/cards/add\");\n  };\n\n  const postCardOwner = useCallback(async () => {\n    let values = {\n      email: profile.e_mail,\n    };\n    setLoading(true);\n    try {\n      const { message, data, success } = await getCards(token, values);\n\n      if (success === false) {\n        let msg = [] as any;\n        msg.push(message);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      }\n      // setResponseMessage(message);\n      setTimeout(function () {\n        setResponseMessage(null);\n      }, 3000);\n      setCardsReponse(data);\n      setErrorMsg([]);\n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n      if (error && !error.response) {\n        let msg = [] as any;\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n      if (error && error.response.status === 500) {\n        let msg = [] as any;\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n      const {\n        response: { data },\n      } = error;\n      data.errors && updateErrors(data.errors);\n    }\n  }, [token, profile.e_mail]);\n\n  useEffect(() => {\n    if (profile && profile.e_mail) postCardOwner();\n  }, [profile]);\n\n  const postOtpRequest = async () => {\n    setLoading(true);\n    try {\n      const {\n        message: OtpRequestMessage,\n        data: OtpRequestData,\n        status: OtpRequestStatus,\n      } = await sendOtpRequest(token);\n\n      if (OtpRequestStatus === false) {\n        let msg = [] as any;\n        msg.push(OtpRequestMessage);\n        setErrorMsg(msg);\n        setLoading(false);\n        return;\n      }\n      setOtpRequestMessage(OtpRequestMessage);\n      setShowCardsList(false);\n      setShowOtpForm(true);\n      setTimeout(function () {\n        setOtpRequestMessage(null);\n      }, 4000);\n      setOtpRequestResponseData(OtpRequestData);\n      setErrorMsg([]);\n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n      if (error && !error.response) {\n        let msg = [] as any;\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n      if (error && error.response.status === 500) {\n        let msg = [] as any;\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n      const {\n        response: { data },\n      } = error;\n      data.errors && updateErrors(data.errors);\n    }\n  };\n\n  const submitRepayment = async () => {\n    setSubmitting(true);\n\n    let values = {\n      otp: userOtpInput,\n      requestid: otpRequestResponseData.otprequestid,\n      amount: amountToPay,\n      payment_type: 2,\n      description: \"On Demand Charge\",\n      card_id: selectedCard,\n      loan_id: loanId,\n    };\n\n    try {\n      const {\n        message: repaymentResponseMessage,\n        data: repaymentResponseData,\n        status: repaymentResponseStatus,\n      } = await payWithExistingCard(token, values);\n\n      if (repaymentResponseStatus === false) {\n        let msg = [] as any;\n        msg.push(repaymentResponseMessage);\n        setErrorMsg(msg);\n        setSubmitting(false);\n        return;\n      }\n      setRepaymentMessage(repaymentResponseMessage);\n      setErrorMsg([]);\n      props.history.replace({\n        pathname: \"/pay/success\",\n        referrerData: { loan_id: loanId },\n      });\n      setSubmitting(false);\n    } catch (error) {\n      setSubmitting(false);\n      if (error && !error.response) {\n        let msg = [] as any;\n        msg.push(\"Network Error, Check Your Internet Connection\");\n        setErrorMsg(msg);\n        return;\n      }\n      if (error && error.response.status === 500) {\n        let msg = [] as any;\n        msg.push(error.response.data.message);\n        setErrorMsg(msg);\n        return;\n      }\n      const {\n        response: { data },\n      } = error;\n      data.errors && updateErrors(data.errors);\n    }\n  };\n\n  const _handleCardSelection = (id) => {\n    setSelectedCard(id);\n  };\n\n  const _handleAuthorizeToPay = () => {\n    postOtpRequest();\n  };\n\n  const _handleUserOtpInput = (e) => {\n    setUserOtpInput(e.target.value);\n  };\n\n  if (isLoading || !profile.e_mail) {\n    return (\n      <>\n        <img src=\"/img/loading-gif.gif\" alt=\"\" className=\"w-1/8 m-auto py-10\" />\n        <h6 className=\"m-auto text-lg text-gray-700 text-center\">\n          Please wait while we process your request...\n        </h6>\n      </>\n    );\n  }\n\n  if (submitting) {\n    return (\n      <>\n        <div className=\"w-11/12 bg-white rounded py-12 shadow-lg m-auto px-8 relative mt-20\">\n          <img\n            src=\"/img/loading-gif.gif\"\n            alt=\"\"\n            className=\"w-1/8 m-auto py-10\"\n          />\n          <h6 className=\"m-auto text-lg text-gray-700 text-center\">\n            Hold on, while we attempt to charge your card...\n          </h6>\n        </div>\n      </>\n    );\n  }\n\n  if (amountToPay === null || loanId === null) {\n    return (\n      <>\n        <div className=\"w-11/12 bg-white rounded py-12 m-auto px-4 relative mt-20\">\n          <img\n            src=\"/img/error-icon.svg\"\n            alt=\"\"\n            className=\"w-2/4 md:w-1/4 m-auto\"\n          />\n          <h6 className=\"m-auto text-lg text-red-600 text-center font-semibold mt-4\">\n            Ooops! The system was unable to capture one or more of your payment\n            data. Please try again!\n          </h6>\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <>\n      {errorMsg.length ? (\n        <div\n          className=\"w-11/12 m-auto bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md my-5\"\n          role=\"alert\"\n        >\n          <div className=\"flex\">\n            <div className=\"py-1\">\n              <svg\n                className=\"fill-current h-6 w-6 text-red-500 mr-4\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 20 20\"\n              >\n                <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n              </svg>\n            </div>\n            <div>\n              <ul style={{ listStyleType: \"none\" }}>\n                {errorMsg.map((error, i) => (\n                  <li key={i}>{error}</li>\n                ))}\n              </ul>\n            </div>\n          </div>\n        </div>\n      ) : (\n        \"\"\n      )}\n      {responseMessage && cardsReponse?.length > 0 ? (\n        <div\n          className=\"w-11/12 m-auto bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\"\n          role=\"alert\"\n        >\n          <div className=\"flex\">\n            <div className=\"py-1\">\n              <svg\n                className=\"fill-current h-6 w-6 text-teal-500 mr-4\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 20 20\"\n              >\n                <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n              </svg>\n            </div>\n            <div>\n              <p className=\"text-sm\">{responseMessage}</p>\n            </div>\n          </div>\n        </div>\n      ) : otpRequestMessage ? (\n        <div\n          className=\"w-11/12 m-auto bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\"\n          role=\"alert\"\n        >\n          <div className=\"flex\">\n            <div className=\"py-1\">\n              <svg\n                className=\"fill-current h-6 w-6 text-teal-500 mr-4\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 20 20\"\n              >\n                <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n              </svg>\n            </div>\n            <div>\n              <p className=\"text-sm\">{otpRequestMessage}</p>\n            </div>\n          </div>\n        </div>\n      ) : repaymentMessage ? (\n        <div\n          className=\"w-11/12 m-auto bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fade-in\"\n          role=\"alert\"\n        >\n          <div className=\"flex\">\n            <div className=\"py-1\">\n              <svg\n                className=\"fill-current h-6 w-6 text-teal-500 mr-4\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 20 20\"\n              >\n                <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n              </svg>\n            </div>\n            <div>\n              <p className=\"text-sm\">{repaymentMessage}</p>\n            </div>\n          </div>\n        </div>\n      ) : null}\n\n      {showOtpForm ? (\n        <>\n          <p className=\"text-green-700 font-medium text-center my-6\">\n            We have sent a code to your phone. Please enter the code below.\n          </p>\n          <div className=\"md:flex justify-center w-full\">\n            <div className=\"md:w-3/5 px-3 \">\n              <input\n                name=\"otp\"\n                onInput={_handleUserOtpInput}\n                className=\"shadow appearance-none border rounded w-full py-3 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                type=\"number\"\n                placeholder=\"Enter the OTP sent to your phone...\"\n              />\n            </div>\n            <button\n              onClick={submitRepayment}\n              disabled={submitting}\n              className=\"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center justify-center my-3 md:my-0 ml-3\"\n              type=\"button\"\n            >\n              <span> Confirm & Pay</span>\n              {!submitting ? (\n                <svg\n                  className=\"ml-2\"\n                  width=\"18\"\n                  height=\"18\"\n                  viewBox=\"0 0 18 18\"\n                  fill=\"none\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <g id=\"done_24px\">\n                    <path\n                      id=\"icon/action/done_24px\"\n                      d=\"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\"\n                      fill=\"white\"\n                    />\n                  </g>\n                </svg>\n              ) : (\n                <img src=\"/img/25.gif\" className=\"ml-2\" alt=\"\" />\n              )}\n            </button>\n          </div>\n          <div className=\"md:flex justify-center w-full\">\n            <div className=\"md:w-3/5 px-3 \"></div>\n            <button\n              disabled={submitting}\n              className=\"bg-blue-700 hover:bg-blue-800 text-white text-sm font-light py-3 px-10 rounded focus:outline-none focus:shadow-outline inline-flex items-center justify-center my-3 md:my-0 ml-3\"\n              type=\"button\"\n            >\n              <span> Resend OTP</span>\n              {!submitting ? (\n                <svg\n                  className=\"ml-2\"\n                  width=\"18\"\n                  height=\"18\"\n                  viewBox=\"0 0 18 18\"\n                  fill=\"none\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <g id=\"done_24px\">\n                    <path\n                      id=\"icon/action/done_24px\"\n                      d=\"M6.5999 11.925L3.4499 8.775L2.3999 9.825L6.5999 14.025L15.5999 5.025L14.5499 3.975L6.5999 11.925Z\"\n                      fill=\"white\"\n                    />\n                  </g>\n                </svg>\n              ) : (\n                <img src=\"/img/25.gif\" className=\"ml-2\" alt=\"\" />\n              )}\n            </button>\n          </div>\n        </>\n      ) : null}\n\n      {showCardsList && cardsReponse?.length > 0 ? (\n        <>\n          <div className=\"w-11/12 m-auto\">\n            <div className=\"w-9/12 m-auto mt-4\">\n              <h3 className=\"text-md md:text-xl text-gray-700 text-left font-semibold mb-4\">\n                Select your card:\n              </h3>\n            </div>\n            <div className=\"relative w-9/12 m-auto\">\n              <svg\n                className=\"w-2 h-2 absolute top-0 right-0 m-4 pointer-events-none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 412 232\"\n              >\n                <path\n                  d=\"M206 171.144L42.678 7.822c-9.763-9.763-25.592-9.763-35.355 0-9.763 9.764-9.763 25.592 0 35.355l181 181c4.88 4.882 11.279 7.323 17.677 7.323s12.796-2.441 17.678-7.322l181-181c9.763-9.764 9.763-25.592 0-35.355-9.763-9.763-25.592-9.763-35.355 0L206 171.144z\"\n                  fill=\"#648299\"\n                />\n              </svg>\n              <select\n                className=\"w-full border border-gray-300 rounded-full text-gray-600 h-10 pl-5 pr-10 bg-white hover:border-gray-400 focus:outline-none appearance-none m-auto\"\n                onChange={(e) => _handleCardSelection(e.target.value)}\n              >\n                <option value=\"\">-- Select a card --</option>\n                {cardsReponse &&\n                  cardsReponse.map((card, key) => {\n                    return (\n                      <option key={key} value={card.id}>\n                        XXXX-{card.last4} - Exp: {card.exp_month}/\n                        {card.exp_year.slice(-2)} ({card.card_type.trim()})\n                      </option>\n                    );\n                  })}\n              </select>\n            </div>\n            <div className=\"w-full m-auto mt-10\">\n              <button\n                disabled={selectedCard ? false : true}\n                onClick={_handleAuthorizeToPay}\n                className={\n                  !selectedCard\n                    ? \"flex w-2/4 md:w-1/4 text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-gray-200 rounded-md m-auto cursor-not-allowed\"\n                    : \"flex w-2/4 md:w-1/4 shadow-xl text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-green-600 hover:bg-green-700 rounded-md m-auto transition-colors duration-150 ease-in-out\"\n                }\n              >\n                <span className=\"text-sm xl:text-lg lg:text-sm pr-2\">\n                  Proceed\n                </span>\n                <img src=\"/img/chevron-right.svg\" className=\"w-5 pt-1\" alt=\"\" />\n              </button>\n            </div>\n          </div>\n        </>\n      ) : showCardsList && cardsReponse?.length === 0 ? (\n        <>\n          <div className=\"w-full m-auto mb-6\">\n            <img\n              src=\"/img/check-files.svg\"\n              alt=\"\"\n              className=\"w-3/4 md:w-2/4 m-auto opacity-50\"\n            />\n          </div>\n          <div className=\"w-3/4 m-auto\">\n            <p className=\"text-gray-700 font-medium text-center\">\n              We found no cards on your profile. Please add a card!\n            </p>\n          </div>\n          <div className=\"flex justify-center items-center h-16 my-2 md:my-6\">\n            <button\n              className=\"flex bg-blue-200 hover:bg-blue-300 items-center py-2 px-4 rounded-lg transition-colors duration-150 ease-in-out cursor-pointer\"\n              onClick={goToAddCard}\n            >\n              <div>\n                <svg\n                  width=\"24\"\n                  height=\"25\"\n                  viewBox=\"0 0 24 25\"\n                  fill=\"none\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <g id=\"add_24px\">\n                    <path\n                      id=\"icon/content/add_24px\"\n                      d=\"M19 13.3832H13V19.229H11V13.3832H5V11.4346H11V5.58878H13V11.4346H19V13.3832Z\"\n                      fill=\"#0A54A2\"\n                    />\n                  </g>\n                </svg>\n              </div>\n              <div className=\"ml-2 text-blue-700 text-md\">Add Card</div>\n            </button>\n          </div>\n        </>\n      ) : null}\n    </>\n  );\n};\n\nexport default withRouter(PayWithExistingCard);\n"]},"metadata":{},"sourceType":"module"}