{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/react app/agilecreditportal/src/pages/AddCard.tsx\";\nimport React, { useState } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { getAddCardFee } from \"../clients/cards\";\nimport useAuthStore from \"../stores/authStore\";\nimport useProfileStore from \"../stores/profileStore\";\nimport { useQuery } from \"react-query\";\nimport { PaystackConsumer } from \"react-paystack\";\n\nconst AddCard = props => {\n  var _process$env$REACT_AP;\n\n  const token = useAuthStore(state => state.accessToken);\n  const [isLoading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState([]);\n  const [responseData, setResponseData] = useState();\n  const [submitted, setSubmitted] = useState(false);\n  const profile = useProfileStore(state => state.data);\n\n  const updateErrors = errors => {\n    setErrorMsg(Object.values(errors).flat());\n  };\n\n  const {\n    isLoading: isPreAuthFeeLoading,\n    error: preAuthFeeError,\n    data: preAuthFeeData\n  } = useQuery(\"fee\", () => getAddCardFee(token));\n\n  if (preAuthFeeError) {\n    let msg = [];\n    msg.push(\"Could not load card fee. Please reload the page!\");\n    setErrorMsg(msg);\n    setLoading(false);\n  }\n\n  const _handlePrematurePaymentModalClose = () => {\n    let msg = [];\n    msg.push(\"You have chosen not to proceed with the payment! Feel free to try again.\");\n    setErrorMsg(msg);\n    return;\n  };\n\n  const psConfig = {\n    reference: new Date().getTime().toString(),\n    email: profile.e_mail,\n    amount: preAuthFeeData,\n    publicKey: (_process$env$REACT_AP = process.env.REACT_APP_PAYSTACK_PUBLIC_KEY) !== null && _process$env$REACT_AP !== void 0 ? _process$env$REACT_AP : \"\"\n  };\n  const componentProps = { ...psConfig,\n    text: \"Proceed to pay\",\n    onSuccess: transaction => {\n      props.history.replace({\n        pathname: \"/pay/process\",\n        referrerData: {\n          amount: preAuthFeeData,\n          payment_type: 0,\n          item_id: null,\n          reference: transaction.reference\n        }\n      });\n    },\n    onClose: _handlePrematurePaymentModalClose\n  };\n\n  if (isLoading || !profile.e_mail || isPreAuthFeeLoading || !preAuthFeeData) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"w-11/12 bg-white rounded py-12 shadow-lg m-auto px-8 relative mt-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"/img/loading-gif.gif\",\n      alt: \"\",\n      className: \"w-1/8 m-auto py-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"m-auto text-lg text-gray-700 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 11\n      }\n    }, \"Please wait...\")));\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"main\", {\n    className: \"md:pl-12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full \",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex items-center mt-10 lg:mt-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-8 h-1 bg-blue-700 rounded mr-0 hidden md:block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"h4\", {\n    className: \"bg-blue-700 md:bg-transparent text-white md:text-gray-700 font-normal md:font-semibold text-md md:text-xl tracking-wide uppercase md:normal-case py-2 px-6 rounded-r-lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 15\n    }\n  }, \"Add New Card\")), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }\n  }), errorMsg.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md mb-5 m-auto md:m-0 md:mb-2\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"py-1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"svg\", {\n    className: \"fill-current h-6 w-6 text-red-500 mr-4\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"ul\", {\n    style: {\n      listStyleType: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 21\n    }\n  }, errorMsg.map((error, i) => /*#__PURE__*/React.createElement(\"li\", {\n    key: i,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 25\n    }\n  }, error)))))) : \"\", !submitted ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"relative w-11/12 bg-white rounded py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0 mt-12 md:mt-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full m-auto mb-6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/payment-svg-naira.svg\",\n    alt: \"\",\n    className: \"w-2/4 md:w-1/4 m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-3/4 md:w-2/4 m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-gray-700 font-medium text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 21\n    }\n  }, \"You will be charged \\u20A6\", Number(preAuthFeeData) / 100, \" to confirm the validity of your card. \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 58\n    }\n  }), \" Click proceed to continue.\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full m-auto mt-10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(PaystackConsumer, Object.assign({}, componentProps, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 21\n    }\n  }), ({\n    initializePayment\n  }) => /*#__PURE__*/React.createElement(\"button\", {\n    disabled: !!!profile.e_mail,\n    onClick: () => {\n      errorMsg.length = 0;\n      initializePayment();\n    },\n    className: !profile.e_mail ? \"flex w-2/4 md:w-1/4 shadow-xl text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-gray-200 rounded-md m-auto cursor-not-allowed\" : \"flex w-2/4 md:w-1/4 shadow-xl text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-green-600 hover:bg-green-700 rounded-md m-auto transition-colors duration-150 ease-in-out\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-sm xl:text-lg lg:text-sm pr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 27\n    }\n  }, \"Proceed\"), /*#__PURE__*/React.createElement(\"img\", {\n    src: \"/img/chevron-right.svg\",\n    className: \"w-5 pt-1\",\n    alt: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 27\n    }\n  })))))) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 bg-white rounded py-6 md:py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"block text-green-600 text-sm md:text-lg font-semibold mb-6 fade-in text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 19\n    }\n  }, \"Redirecting you to the payment gateway.\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-11/12 mt-8 hidden md:block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"hr\", {\n    className: \"w-9/12 border-t-2 border-blue-600 bg-blue-400 rounded m-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 19\n    }\n  }))))), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default withRouter(AddCard);","map":{"version":3,"sources":["/Users/mac/Documents/react app/agilecreditportal/src/pages/AddCard.tsx"],"names":["React","useState","withRouter","getAddCardFee","useAuthStore","useProfileStore","useQuery","PaystackConsumer","AddCard","props","token","state","accessToken","isLoading","setLoading","errorMsg","setErrorMsg","responseData","setResponseData","submitted","setSubmitted","profile","data","updateErrors","errors","Object","values","flat","isPreAuthFeeLoading","error","preAuthFeeError","preAuthFeeData","msg","push","_handlePrematurePaymentModalClose","psConfig","reference","Date","getTime","toString","email","e_mail","amount","publicKey","process","env","REACT_APP_PAYSTACK_PUBLIC_KEY","componentProps","text","onSuccess","transaction","history","replace","pathname","referrerData","payment_type","item_id","onClose","length","listStyleType","map","i","Number","initializePayment"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { withRouter } from \"react-router\";\nimport { getAddCardFee, sendCardPreAuth } from \"../clients/cards\";\nimport useAuthStore from \"../stores/authStore\";\nimport useProfileStore from \"../stores/profileStore\";\nimport { useQuery } from \"react-query\";\nimport { PaystackConsumer } from \"react-paystack\";\n\nconst AddCard = (props: any) => {\n  const token = useAuthStore((state) => state.accessToken);\n\n  const [isLoading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState([]);\n  const [responseData, setResponseData]: any = useState();\n  const [submitted, setSubmitted] = useState(false);\n\n  const profile: any = useProfileStore((state) => state.data);\n\n  const updateErrors = (errors: []) => {\n    setErrorMsg(Object.values(errors).flat());\n  };\n\n  const {\n    isLoading: isPreAuthFeeLoading,\n    error: preAuthFeeError,\n    data: preAuthFeeData,\n  } = useQuery(\"fee\", () => getAddCardFee(token));\n\n  if (preAuthFeeError) {\n    let msg = [] as any;\n    msg.push(\"Could not load card fee. Please reload the page!\");\n    setErrorMsg(msg);\n    setLoading(false);\n  }\n\n  const _handlePrematurePaymentModalClose = () => {\n    let msg = [] as any;\n    msg.push(\n      \"You have chosen not to proceed with the payment! Feel free to try again.\"\n    );\n    setErrorMsg(msg);\n    return;\n  };\n\n  const psConfig = {\n    reference: new Date().getTime().toString(),\n    email: profile.e_mail,\n    amount: preAuthFeeData,\n    publicKey: process.env.REACT_APP_PAYSTACK_PUBLIC_KEY ?? \"\",\n  };\n\n  const componentProps = {\n    ...psConfig,\n    text: \"Proceed to pay\",\n    onSuccess: (transaction) => { \n      props.history.replace({\n        pathname: \"/pay/process\",\n        referrerData: {\n          amount: preAuthFeeData,\n          payment_type: 0,\n          item_id: null,\n          reference: transaction.reference\n        },\n      })\n    },\n    onClose: _handlePrematurePaymentModalClose,\n  };\n\n  if (isLoading || !profile.e_mail || isPreAuthFeeLoading || !preAuthFeeData) {\n    return (\n      <>\n        <div className=\"w-11/12 bg-white rounded py-12 shadow-lg m-auto px-8 relative mt-10\">\n          <img\n            src=\"/img/loading-gif.gif\"\n            alt=\"\"\n            className=\"w-1/8 m-auto py-10\"\n          />\n          <h6 className=\"m-auto text-lg text-gray-700 text-center\">\n            Please wait...\n          </h6>\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <>\n      <main className=\"md:pl-12\">\n        <div className=\"flex \">\n          <div className=\"w-full \">\n            <div className=\"flex items-center mt-10 lg:mt-0\">\n              <div className=\"w-8 h-1 bg-blue-700 rounded mr-0 hidden md:block\"></div>\n              <h4 className=\"bg-blue-700 md:bg-transparent text-white md:text-gray-700 font-normal md:font-semibold text-md md:text-xl tracking-wide uppercase md:normal-case py-2 px-6 rounded-r-lg\">\n                Add New Card\n              </h4>\n            </div>\n            <br />\n\n            {errorMsg.length ? (\n              <div\n                className=\"w-11/12 bg-red-100 border-t-4 border-red-500 rounded-b text-red-900 px-4 py-3 shadow-md mb-5 m-auto md:m-0 md:mb-2\"\n                role=\"alert\"\n              >\n                <div className=\"flex\">\n                  <div className=\"py-1\">\n                    <svg\n                      className=\"fill-current h-6 w-6 text-red-500 mr-4\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      viewBox=\"0 0 20 20\"\n                    >\n                      <path d=\"M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z\" />\n                    </svg>\n                  </div>\n                  <div>\n                    <ul style={{ listStyleType: \"none\" }}>\n                      {errorMsg.map((error, i) => (\n                        <li key={i}>{error}</li>\n                      ))}\n                    </ul>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              \"\"\n            )}\n\n            {!submitted ? (\n              <>\n                <div className=\"relative w-11/12 bg-white rounded py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0 mt-12 md:mt-0\">\n                  <div className=\"w-full m-auto mb-6\">\n                    <img\n                      src=\"/img/payment-svg-naira.svg\"\n                      alt=\"\"\n                      className=\"w-2/4 md:w-1/4 m-auto\"\n                    />\n                  </div>\n                  <div className=\"w-3/4 md:w-2/4 m-auto\">\n                    <p className=\"text-gray-700 font-medium text-center\">\n                      You will be charged ₦{Number(preAuthFeeData) / 100} to\n                      confirm the validity of your card. <br /> Click proceed to\n                      continue.\n                    </p>\n                  </div>\n                  <div className=\"w-full m-auto mt-10\">\n                    <PaystackConsumer {...componentProps}>\n                      {({ initializePayment }) => (\n                        <button\n                          disabled={!!!profile.e_mail}\n                          onClick={() => {\n                            errorMsg.length = 0;\n                            initializePayment();\n                          }}\n                          className={\n                            !profile.e_mail\n                              ? \"flex w-2/4 md:w-1/4 shadow-xl text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-gray-200 rounded-md m-auto cursor-not-allowed\"\n                              : \"flex w-2/4 md:w-1/4 shadow-xl text-xl font-light text-white justify-center py-4 md:py-3 items-center bg-green-600 hover:bg-green-700 rounded-md m-auto transition-colors duration-150 ease-in-out\"\n                          }\n                        >\n                          <span className=\"text-sm xl:text-lg lg:text-sm pr-2\">\n                            Proceed\n                          </span>\n                          <img\n                            src=\"/img/chevron-right.svg\"\n                            className=\"w-5 pt-1\"\n                            alt=\"\"\n                          />\n                        </button>\n                      )}\n                    </PaystackConsumer>\n                  </div>\n                </div>\n              </>\n            ) : (\n              <>\n                <div className=\"w-11/12 bg-white rounded py-6 md:py-12 shadow-lg border-b-4 border-blue-700 md:border-none mb-20 m-auto md:m-0\">\n                  <h3 className=\"block text-green-600 text-sm md:text-lg font-semibold mb-6 fade-in text-center\">\n                    Redirecting you to the payment gateway.\n                  </h3>\n                </div>\n                <div className=\"w-11/12 mt-8 hidden md:block\">\n                  <hr className=\"w-9/12 border-t-2 border-blue-600 bg-blue-400 rounded m-auto\"></hr>\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n        <br />\n      </main>\n    </>\n  );\n};\n\nexport default withRouter(AddCard);\n"]},"metadata":{},"sourceType":"module"}