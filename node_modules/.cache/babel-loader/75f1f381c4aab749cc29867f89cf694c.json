{"ast":null,"code":"var _jsxFileName = \"/Users/mac/Documents/react app/agilecreditportal/src/App.tsx\";\nimport React, { useEffect, useCallback } from \"react\";\nimport { BrowserRouter as Router, Switch, Route, useHistory } from \"react-router-dom\";\nimport Keycloak from \"keycloak-js\";\nimport Layout from \"./components/Layout\";\nimport Home from \"./pages/Home\";\nimport Profile from \"./pages/Profile\";\nimport Onboarding from \"./pages/Onboarding\";\nimport useAuthStore from \"./stores/authStore\";\nimport useProfileStore from \"./stores/profileStore\";\nimport MyLoans from \"./pages/MyLoans\";\nimport NewLoanRequest from \"./pages/NewLoanRequest\";\nimport LoanSchedule from \"./pages/LoanSchedule\";\nimport LoanApplication from \"./pages/LoanApplication\";\nimport { getPersonalDetails } from \"./clients/profile\";\nimport { getProfileSection } from \"./clients/onboarding\";\nimport LoanRequests from \"./pages/LoanRequests\";\nexport default function App() {\n  const history = useHistory();\n  const authenticated = useAuthStore(useCallback(state => state.authenticated, []));\n  const initializeAuthStore = useAuthStore(useCallback(state => state.initialize, []));\n  const initializeProfileStore = useProfileStore(useCallback(state => state.initialize, []));\n  const initializeProfileSection = useProfileStore(useCallback(state => state.initializeProfileSection, []));\n\n  const _initializeStores = useCallback(async keycloak => {\n    initializeAuthStore(keycloak);\n    const {\n      token\n    } = keycloak;\n\n    try {\n      const {\n        data\n      } = await getPersonalDetails(token);\n      const checklist = await getProfileSection(token);\n      initializeProfileStore(data);\n      initializeProfileSection(checklist.reverse(), checklist.every(loan => loan.completed === true));\n    } catch (error) {}\n  }, [initializeAuthStore, initializeProfileSection, initializeProfileStore]);\n\n  const _refreshToken = useCallback(async keycloak => {\n    keycloak.updateToken(70).then(async refreshed => {\n      if (refreshed) {\n        initializeAuthStore(keycloak);\n      }\n    }).catch(err => {\n      keycloak.logout();\n      history.replace(\"/\");\n    });\n  }, [initializeAuthStore, history]);\n\n  const _initializeAuthentication = useCallback(() => {\n    var _process$env$REACT_AP, _process$env$REACT_AP2, _process$env$REACT_AP3;\n\n    const keycloak = Keycloak({\n      realm: (_process$env$REACT_AP = process.env.REACT_APP_AUTH_REALM) !== null && _process$env$REACT_AP !== void 0 ? _process$env$REACT_AP : \"\",\n      url: (_process$env$REACT_AP2 = process.env.REACT_APP_AUTH_SERVER_URL) !== null && _process$env$REACT_AP2 !== void 0 ? _process$env$REACT_AP2 : \"\",\n      clientId: (_process$env$REACT_AP3 = process.env.REACT_APP_AUTH_CLIENT_ID) !== null && _process$env$REACT_AP3 !== void 0 ? _process$env$REACT_AP3 : \"\"\n    });\n    keycloak.init({\n      onLoad: \"login-required\"\n    }).then(async authenticated => {\n      if (authenticated) {\n        _initializeStores(keycloak);\n      }\n\n      setInterval(() => _refreshToken(keycloak), 60000);\n    });\n  }, [_initializeStores, _refreshToken]);\n\n  useEffect(() => {\n    _initializeAuthentication();\n\n    return () => {};\n  }, [_initializeAuthentication]);\n\n  if (!authenticated) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"w-full m-auto px-8 relative\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: \"/img/loading-gif.gif\",\n      alt: \"\",\n      className: \"w-1/8 m-auto pt-64 pb-10\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"h6\", {\n      className: \"m-auto text-lg text-gray-700 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }\n    }, \"One moment please...\")));\n  }\n\n  return /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Home, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/new-loan-request\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(NewLoanRequest, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/loan-schedule\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(LoanSchedule, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/profile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Profile, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/loans\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(MyLoans, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/onboarding\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Onboarding, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/application\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(LoanApplication, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"/applications\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(LoanRequests, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  })))));\n}","map":{"version":3,"sources":["/Users/mac/Documents/react app/agilecreditportal/src/App.tsx"],"names":["React","useEffect","useCallback","BrowserRouter","Router","Switch","Route","useHistory","Keycloak","Layout","Home","Profile","Onboarding","useAuthStore","useProfileStore","MyLoans","NewLoanRequest","LoanSchedule","LoanApplication","getPersonalDetails","getProfileSection","LoanRequests","App","history","authenticated","state","initializeAuthStore","initialize","initializeProfileStore","initializeProfileSection","_initializeStores","keycloak","token","data","checklist","reverse","every","loan","completed","error","_refreshToken","updateToken","then","refreshed","catch","err","logout","replace","_initializeAuthentication","realm","process","env","REACT_APP_AUTH_REALM","url","REACT_APP_AUTH_SERVER_URL","clientId","REACT_APP_AUTH_CLIENT_ID","init","onLoad","setInterval"],"mappings":"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","sourcesContent":["import React, { useEffect, useCallback } from \"react\";\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route,\n  useHistory,\n} from \"react-router-dom\";\nimport Keycloak from \"keycloak-js\";\n\nimport Layout from \"./components/Layout\";\nimport Home from \"./pages/Home\";\nimport Profile from \"./pages/Profile\";\nimport Onboarding from \"./pages/Onboarding\";\nimport Bvn from \"./pages/Bvn\";\nimport useAuthStore from \"./stores/authStore\";\nimport useProfileStore from \"./stores/profileStore\";\nimport MyLoans from \"./pages/MyLoans\";\nimport NewLoanRequest from \"./pages/NewLoanRequest\";\nimport LoanSchedule from \"./pages/LoanSchedule\";\nimport LoanApplication from \"./pages/LoanApplication\";\n\nimport { getPersonalDetails } from \"./clients/profile\";\nimport { getProfileSection } from \"./clients/onboarding\";\nimport LoanRequests from \"./pages/LoanRequests\";\n\nexport default function App() {\n  const history = useHistory();\n\n  const authenticated = useAuthStore(\n    useCallback((state) => state.authenticated, [])\n  );\n\n  const initializeAuthStore = useAuthStore(\n    useCallback((state) => state.initialize, [])\n  );\n\n  const initializeProfileStore = useProfileStore(\n    useCallback((state) => state.initialize, [])\n  );\n\n  const initializeProfileSection = useProfileStore(\n    useCallback((state) => state.initializeProfileSection, [])\n  );\n\n  const _initializeStores = useCallback(\n    async (keycloak: Keycloak.KeycloakInstance) => {\n      initializeAuthStore(keycloak);\n      const { token } = keycloak;\n      try {\n        const { data } = await getPersonalDetails(token);\n        const checklist = await getProfileSection(token);\n        initializeProfileStore(data);\n        initializeProfileSection(\n          checklist.reverse(),\n          checklist.every((loan) => loan.completed === true)\n        );\n      } catch (error) {}\n    },\n    [initializeAuthStore, initializeProfileSection, initializeProfileStore]\n  );\n\n  const _refreshToken = useCallback(\n    async (keycloak: Keycloak.KeycloakInstance) => {\n      keycloak\n        .updateToken(70)\n        .then(async (refreshed) => {\n          if (refreshed) {\n            initializeAuthStore(keycloak);\n          }\n        })\n        .catch((err) => {\n          keycloak.logout();\n          history.replace(\"/\");\n        });\n    },\n    [initializeAuthStore, history]\n  );\n\n  const _initializeAuthentication = useCallback(() => {\n    const keycloak = Keycloak({\n      realm: process.env.REACT_APP_AUTH_REALM ?? \"\",\n      url: process.env.REACT_APP_AUTH_SERVER_URL ?? \"\",\n      clientId: process.env.REACT_APP_AUTH_CLIENT_ID ?? \"\",\n    });\n\n    keycloak.init({ onLoad: \"login-required\" }).then(async (authenticated) => {\n      if (authenticated) {\n        _initializeStores(keycloak);\n      }\n      setInterval(() => _refreshToken(keycloak), 60000);\n    });\n  }, [_initializeStores, _refreshToken]);\n\n  useEffect(() => {\n    _initializeAuthentication();\n    return () => {};\n  }, [_initializeAuthentication]);\n\n  if (!authenticated) {\n    return (\n      <>\n        <div className=\"w-full m-auto px-8 relative\">\n          <img src=\"/img/loading-gif.gif\" alt=\"\" className=\"w-1/8 m-auto pt-64 pb-10\" />\n          <h6 className=\"m-auto text-lg text-gray-700 text-center\">One moment please...</h6>\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <Router>\n      <Layout>\n        <Switch>\n          <Route exact path=\"/\">\n            <Home />\n          </Route>\n          <Route path=\"/new-loan-request\">\n            <NewLoanRequest />\n          </Route>\n          <Route path=\"/loan-schedule\">\n            <LoanSchedule />\n          </Route>\n          <Route path=\"/profile\">\n            <Profile />\n          </Route>\n          <Route path=\"/loans\">\n            <MyLoans />\n          </Route>\n          <Route path=\"/onboarding\">\n            <Onboarding />\n          </Route>\n          <Route path=\"/application\">\n            <LoanApplication />\n          </Route>\n          <Route path=\"/applications\">\n            <LoanRequests />\n          </Route>\n        </Switch>\n      </Layout>\n    </Router>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}